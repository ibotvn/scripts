load(Base64Decode("bG9jYWwgVmVyc2lvbiA9IDEuMjgxCgppZiBteUhlcm8uY2hhck5hbWUgfj0gIlZpa3RvciIgdGhlbgogIHJldHVybgplbmQKCmNsYXNzICdTY3JpcHRVcGRhdGUnCmNsYXNzICdIVFRGX1Zpa3RvcicKCnJlcXVpcmUgJ0hQcmVkaWN0aW9uJwoKZnVuY3Rpb24gSFRURl9WaWt0b3I6U2NyaXB0TXNnKG1zZykKICBwcmludCgiPGZvbnQgY29sb3I9XCIjZGFhNTIwXCI+PGI+VHJ1eSBj4bqtcCBodHRwOi8vaWJvdHZuLmNvbSDEkeG7gyBkb3dubG9hZCA8L2I+PC9mb250PiA8Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj4iLi5tc2cuLiI8L2ZvbnQ+IikKZW5kCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBTY3JpcHRVcGRhdGU6X19pbml0KExvY2FsVmVyc2lvbixVc2VIdHRwcywgSG9zdCwgVmVyc2lvblBhdGgsIFNjcmlwdFBhdGgsIFNhdmVQYXRoLCBDYWxsYmFja1VwZGF0ZSwgQ2FsbGJhY2tOb1VwZGF0ZSwgQ2FsbGJhY2tOZXdWZXJzaW9uLENhbGxiYWNrRXJyb3IpCiAgc2VsZi5Mb2NhbFZlcnNpb24gPSBMb2NhbFZlcnNpb24KICBzZWxmLkhvc3QgPSBIb3N0CiAgc2VsZi5WZXJzaW9uUGF0aCA9ICcvQm9ML1RDUFVwZGF0ZXIvR2V0U2NyaXB0Jy4uKFVzZUh0dHBzIGFuZCAnNScgb3IgJzYnKS4uJy5waHA/c2NyaXB0PScuLnNlbGY6QmFzZTY0RW5jb2RlKHNlbGYuSG9zdC4uVmVyc2lvblBhdGgpLi4nJnJhbmQ9Jy4ubWF0aC5yYW5kb20oOTk5OTk5OTkpCiAgc2VsZi5TY3JpcHRQYXRoID0gJy9Cb0wvVENQVXBkYXRlci9HZXRTY3JpcHQnLi4oVXNlSHR0cHMgYW5kICc1JyBvciAnNicpLi4nLnBocD9zY3JpcHQ9Jy4uc2VsZjpCYXNlNjRFbmNvZGUoc2VsZi5Ib3N0Li5TY3JpcHRQYXRoKS4uJyZyYW5kPScuLm1hdGgucmFuZG9tKDk5OTk5OTk5KQogIHNlbGYuU2F2ZVBhdGggPSBTYXZlUGF0aAogIHNlbGYuQ2FsbGJhY2tVcGRhdGUgPSBDYWxsYmFja1VwZGF0ZQogIHNlbGYuQ2FsbGJhY2tOb1VwZGF0ZSA9IENhbGxiYWNrTm9VcGRhdGUKICBzZWxmLkNhbGxiYWNrTmV3VmVyc2lvbiA9IENhbGxiYWNrTmV3VmVyc2lvbgogIHNlbGYuQ2FsbGJhY2tFcnJvciA9IENhbGxiYWNrRXJyb3IKICBBZGREcmF3Q2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOk9uRHJhdygpIGVuZCkKICBzZWxmOkNyZWF0ZVNvY2tldChzZWxmLlZlcnNpb25QYXRoKQogIHNlbGYuRG93bmxvYWRTdGF0dXMgPSAnQ29ubmVjdCB0byBTZXJ2ZXIgZm9yIFZlcnNpb25JbmZvJwogIEFkZFRpY2tDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6R2V0T25saW5lVmVyc2lvbigpIGVuZCkKZW5kCgpmdW5jdGlvbiBTY3JpcHRVcGRhdGU6cHJpbnQoc3RyKQogIHByaW50KCc8Zm9udCBjb2xvcj0iI0ZGRkZGRiI+Jy4ub3MuY2xvY2soKS4uJzogJy4uc3RyKQplbmQKCmZ1bmN0aW9uIFNjcmlwdFVwZGF0ZTpPbkRyYXcoKQoKICBpZiBzZWxmLkRvd25sb2FkU3RhdHVzIH49ICdEb3dubG9hZGluZyBTY3JpcHQgKDEwMCUpJyBhbmQgc2VsZi5Eb3dubG9hZFN0YXR1cyB+PSAnRG93bmxvYWRpbmcgVmVyc2lvbkluZm8gKDEwMCUpJ3RoZW4KICAgIERyYXdUZXh0KCdEb3dubG9hZCBTdGF0dXM6ICcuLihzZWxmLkRvd25sb2FkU3RhdHVzIG9yICdVbmtub3duJyksNTAsMTAsNTAsQVJHQigweEZGLDB4RkYsMHhGRiwweEZGKSkKICBlbmQKICAKZW5kCgpmdW5jdGlvbiBTY3JpcHRVcGRhdGU6Q3JlYXRlU29ja2V0KHVybCkKCiAgaWYgbm90IHNlbGYuTHVhU29ja2V0IHRoZW4KICAgIHNlbGYuTHVhU29ja2V0ID0gcmVxdWlyZSgic29ja2V0IikKICBlbHNlCiAgICBzZWxmLlNvY2tldDpjbG9zZSgpCiAgICBzZWxmLlNvY2tldCA9IG5pbAogICAgc2VsZi5TaXplID0gbmlsCiAgICBzZWxmLlJlY3ZTdGFydGVkID0gZmFsc2UKICBlbmQKICAKICBzZWxmLkx1YVNvY2tldCA9IHJlcXVpcmUoInNvY2tldCIpCiAgc2VsZi5Tb2NrZXQgPSBzZWxmLkx1YVNvY2tldC50Y3AoKQogIHNlbGYuU29ja2V0OnNldHRpbWVvdXQoMCwgJ2InKQogIHNlbGYuU29ja2V0OnNldHRpbWVvdXQoOTk5OTk5OTksICd0JykKICBzZWxmLlNvY2tldDpjb25uZWN0KCdzeC1ib2wuZXUnLCA4MCkKICBzZWxmLlVybCA9IHVybAogIHNlbGYuU3RhcnRlZCA9IGZhbHNlCiAgc2VsZi5MYXN0UHJpbnQgPSAiIgogIHNlbGYuRmlsZSA9ICIiCmVuZAoKZnVuY3Rpb24gU2NyaXB0VXBkYXRlOkJhc2U2NEVuY29kZShkYXRhKQoKICBsb2NhbCBiPSdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvJwogIAogIHJldHVybiAoKGRhdGE6Z3N1YignLicsIGZ1bmN0aW9uKHgpCiAgCiAgICBsb2NhbCByLGI9JycseDpieXRlKCkKICAgIAogICAgZm9yIGk9OCwxLC0xIGRvCiAgICAgIHI9ci4uKGIlMl5pLWIlMl4oaS0xKT4wIGFuZCAnMScgb3IgJzAnKQogICAgZW5kCiAgICAKICAgIHJldHVybiByOwogIGVuZCkuLicwMDAwJyk6Z3N1YignJWQlZCVkPyVkPyVkPyVkPycsIGZ1bmN0aW9uKHgpCiAgCiAgICBpZiAoI3ggPCA2KSB0aGVuCiAgICAgIHJldHVybiAnJwogICAgZW5kCiAgICAKICAgIGxvY2FsIGM9MAogICAgCiAgICBmb3IgaT0xLDYgZG8KICAgICAgYz1jKyh4OnN1YihpLGkpPT0nMScgYW5kIDJeKDYtaSkgb3IgMCkKICAgIGVuZAogICAgCiAgICByZXR1cm4gYjpzdWIoYysxLGMrMSkKICBlbmQpLi4oeyAnJywgJz09JywgJz0nIH0pWyNkYXRhJTMrMV0pCiAgCmVuZAoKZnVuY3Rpb24gU2NyaXB0VXBkYXRlOkdldE9ubGluZVZlcnNpb24oKQoKICBpZiBzZWxmLkdvdFNjcmlwdFZlcnNpb24gdGhlbgogICAgcmV0dXJuCiAgZW5kCiAgCiAgc2VsZi5SZWNlaXZlLCBzZWxmLlN0YXR1cywgc2VsZi5TbmlwcGVkID0gc2VsZi5Tb2NrZXQ6cmVjZWl2ZSgxMDI0KQogIAogIGlmIHNlbGYuU3RhdHVzID09ICd0aW1lb3V0JyBhbmQgbm90IHNlbGYuU3RhcnRlZCB0aGVuCiAgICBzZWxmLlN0YXJ0ZWQgPSB0cnVlCiAgICBzZWxmLlNvY2tldDpzZW5kKCJHRVQgIi4uc2VsZi5VcmwuLiIgSFRUUC8xLjFcclxuSG9zdDogc3gtYm9sLmV1XHJcblxyXG4iKQogIGVuZAogIAogIGlmIChzZWxmLlJlY2VpdmUgb3IgKCNzZWxmLlNuaXBwZWQgPiAwKSkgYW5kIG5vdCBzZWxmLlJlY3ZTdGFydGVkIHRoZW4KICAgIHNlbGYuUmVjdlN0YXJ0ZWQgPSB0cnVlCiAgICBzZWxmLkRvd25sb2FkU3RhdHVzID0gJ0Rvd25sb2FkaW5nIFZlcnNpb25JbmZvICgwJSknCiAgZW5kCiAgCiAgc2VsZi5GaWxlID0gc2VsZi5GaWxlIC4uIChzZWxmLlJlY2VpdmUgb3Igc2VsZi5TbmlwcGVkKQogIAogIGlmIHNlbGYuRmlsZTpmaW5kKCc8L3MnLi4naXplPicpIHRoZW4KICAKICAgIGlmIG5vdCBzZWxmLlNpemUgdGhlbgogICAgICBzZWxmLlNpemUgPSB0b251bWJlcihzZWxmLkZpbGU6c3ViKHNlbGYuRmlsZTpmaW5kKCc8c2knLi4nemU+JykrNixzZWxmLkZpbGU6ZmluZCgnPC9zaScuLid6ZT4nKS0xKSkKICAgIGVuZAogICAgCiAgICBpZiBzZWxmLkZpbGU6ZmluZCgnPHNjcicuLidpcHQ+JykgdGhlbgogICAgCiAgICAgIGxvY2FsIF8sU2NyaXB0RmluZCA9IHNlbGYuRmlsZTpmaW5kKCc8c2NyJy4uJ2lwdD4nKQogICAgICBsb2NhbCBTY3JpcHRFbmQgPSBzZWxmLkZpbGU6ZmluZCgnPC9zY3InLi4naXB0PicpCiAgICAgIAogICAgICBpZiBTY3JpcHRFbmQgdGhlbgogICAgICAgIFNjcmlwdEVuZCA9IFNjcmlwdEVuZC0xCiAgICAgIGVuZAogICAgICAKICAgICAgbG9jYWwgRG93bmxvYWRlZFNpemUgPSBzZWxmLkZpbGU6c3ViKFNjcmlwdEZpbmQrMSxTY3JpcHRFbmQgb3IgLTEpOmxlbigpCiAgICAgIAogICAgICBzZWxmLkRvd25sb2FkU3RhdHVzID0gJ0Rvd25sb2FkaW5nIFZlcnNpb25JbmZvICgnLi5tYXRoLnJvdW5kKDEwMC9zZWxmLlNpemUqRG93bmxvYWRlZFNpemUsMikuLiclKScKICAgIGVuZAogICAgCiAgZW5kCiAgCiAgaWYgc2VsZi5GaWxlOmZpbmQoJzwvc2NyJy4uJ2lwdD4nKSB0aGVuCiAgICBzZWxmLkRvd25sb2FkU3RhdHVzID0gJ0Rvd25sb2FkaW5nIFZlcnNpb25JbmZvICgxMDAlKScKICAgIAogICAgbG9jYWwgYSxiID0gc2VsZi5GaWxlOmZpbmQoJ1xyXG5cclxuJykKICAgIAogICAgc2VsZi5GaWxlID0gc2VsZi5GaWxlOnN1YihhLC0xKQogICAgIHNlbGYuTmV3RmlsZSA9ICcnCiAgICAKICAgIGZvciBsaW5lLGNvbnRlbnQgaW4gaXBhaXJzKHNlbGYuRmlsZTpzcGxpdCgnXG4nKSkgZG8KICAgIAogICAgICBpZiBjb250ZW50OmxlbigpID4gNSB0aGVuCiAgICAgICAgc2VsZi5OZXdGaWxlID0gc2VsZi5OZXdGaWxlIC4uIGNvbnRlbnQKICAgICAgZW5kCiAgICAgIAogICAgZW5kCiAgICAKICAgIGxvY2FsIEhlYWRlckVuZCwgQ29udGVudFN0YXJ0ID0gc2VsZi5GaWxlOmZpbmQoJzxzY3InLi4naXB0PicpCiAgICBsb2NhbCBDb250ZW50RW5kLCBfID0gc2VsZi5GaWxlOmZpbmQoJzwvc2MnLi4ncmlwdD4nKQogICAgCiAgICBpZiBub3QgQ29udGVudFN0YXJ0IG9yIG5vdCBDb250ZW50RW5kIHRoZW4KICAgIAogICAgICBpZiBzZWxmLkNhbGxiYWNrRXJyb3IgYW5kIHR5cGUoc2VsZi5DYWxsYmFja0Vycm9yKSA9PSAnZnVuY3Rpb24nIHRoZW4KICAgICAgICBzZWxmLkNhbGxiYWNrRXJyb3IoKQogICAgICBlbmQKICAgICAgCiAgICBlbHNlCiAgICAgIHNlbGYuT25saW5lVmVyc2lvbiA9IChCYXNlNjREZWNvZGUoc2VsZi5GaWxlOnN1YihDb250ZW50U3RhcnQrMSxDb250ZW50RW5kLTEpKSkKICAgICAgc2VsZi5PbmxpbmVWZXJzaW9uID0gdG9udW1iZXIoc2VsZi5PbmxpbmVWZXJzaW9uKQogICAgICAKICAgICAgaWYgc2VsZi5PbmxpbmVWZXJzaW9uID4gc2VsZi5Mb2NhbFZlcnNpb24gdGhlbgogICAgICAKICAgICAgICBpZiBzZWxmLkNhbGxiYWNrTmV3VmVyc2lvbiBhbmQgdHlwZShzZWxmLkNhbGxiYWNrTmV3VmVyc2lvbikgPT0gJ2Z1bmN0aW9uJyB0aGVuCiAgICAgICAgICBzZWxmLkNhbGxiYWNrTmV3VmVyc2lvbihzZWxmLk9ubGluZVZlcnNpb24sc2VsZi5Mb2NhbFZlcnNpb24pCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgc2VsZjpDcmVhdGVTb2NrZXQoc2VsZi5TY3JpcHRQYXRoKQogICAgICAgIHNlbGYuRG93bmxvYWRTdGF0dXMgPSAnQ29ubmVjdCB0byBTZXJ2ZXIgZm9yIFNjcmlwdERvd25sb2FkJwogICAgICAgIEFkZFRpY2tDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6RG93bmxvYWRVcGRhdGUoKSBlbmQpCiAgICAgIGVsc2UKICAgICAgICAKICAgICAgICBpZiBzZWxmLkNhbGxiYWNrTm9VcGRhdGUgYW5kIHR5cGUoc2VsZi5DYWxsYmFja05vVXBkYXRlKSA9PSAnZnVuY3Rpb24nIHRoZW4KICAgICAgICAgIHNlbGYuQ2FsbGJhY2tOb1VwZGF0ZShzZWxmLkxvY2FsVmVyc2lvbikKICAgICAgICBlbmQKICAgICAgICAKICAgICAgZW5kCiAgICAgIAogICAgZW5kCiAgICAKICAgIHNlbGYuR290U2NyaXB0VmVyc2lvbiA9IHRydWUKICBlbmQKICAKZW5kCgpmdW5jdGlvbiBTY3JpcHRVcGRhdGU6RG93bmxvYWRVcGRhdGUoKQoKICBpZiBzZWxmLkdvdFNjcmlwdFVwZGF0ZSB0aGVuCiAgICByZXR1cm4KICBlbmQKICAKICBzZWxmLlJlY2VpdmUsIHNlbGYuU3RhdHVzLCBzZWxmLlNuaXBwZWQgPSBzZWxmLlNvY2tldDpyZWNlaXZlKDEwMjQpCiAgCiAgaWYgc2VsZi5TdGF0dXMgPT0gJ3RpbWVvdXQnIGFuZCBub3Qgc2VsZi5TdGFydGVkIHRoZW4KICAgIHNlbGYuU3RhcnRlZCA9IHRydWUKICAgIHNlbGYuU29ja2V0OnNlbmQoIkdFVCAiLi5zZWxmLlVybC4uIiBIVFRQLzEuMVxyXG5Ib3N0OiBzeC1ib2wuZXVcclxuXHJcbiIpCiAgZW5kCiAgCiAgaWYgKHNlbGYuUmVjZWl2ZSBvciAoI3NlbGYuU25pcHBlZCA+IDApKSBhbmQgbm90IHNlbGYuUmVjdlN0YXJ0ZWQgdGhlbgogICAgc2VsZi5SZWN2U3RhcnRlZCA9IHRydWUKICAgIHNlbGYuRG93bmxvYWRTdGF0dXMgPSAnRG93bmxvYWRpbmcgU2NyaXB0ICgwJSknCiAgZW5kCiAgCiAgc2VsZi5GaWxlID0gc2VsZi5GaWxlIC4uIChzZWxmLlJlY2VpdmUgb3Igc2VsZi5TbmlwcGVkKQogIAogIGlmIHNlbGYuRmlsZTpmaW5kKCc8L3NpJy4uJ3plPicpIHRoZW4KICAKICAgIGlmIG5vdCBzZWxmLlNpemUgdGhlbgogICAgICBzZWxmLlNpemUgPSB0b251bWJlcihzZWxmLkZpbGU6c3ViKHNlbGYuRmlsZTpmaW5kKCc8c2knLi4nemU+JykrNixzZWxmLkZpbGU6ZmluZCgnPC9zaScuLid6ZT4nKS0xKSkKICAgIGVuZAogICAgCiAgICBpZiBzZWxmLkZpbGU6ZmluZCgnPHNjcicuLidpcHQ+JykgdGhlbgogICAgCiAgICAgIGxvY2FsIF8sU2NyaXB0RmluZCA9IHNlbGYuRmlsZTpmaW5kKCc8c2NyJy4uJ2lwdD4nKQogICAgICBsb2NhbCBTY3JpcHRFbmQgPSBzZWxmLkZpbGU6ZmluZCgnPC9zY3InLi4naXB0PicpCiAgICAgIAogICAgICBpZiBTY3JpcHRFbmQgdGhlbgogICAgICAgIFNjcmlwdEVuZCA9IFNjcmlwdEVuZC0xCiAgICAgIGVuZAogICAgICAKICAgICAgbG9jYWwgRG93bmxvYWRlZFNpemUgPSBzZWxmLkZpbGU6c3ViKFNjcmlwdEZpbmQrMSxTY3JpcHRFbmQgb3IgLTEpOmxlbigpCiAgICAgIAogICAgICBzZWxmLkRvd25sb2FkU3RhdHVzID0gJ0Rvd25sb2FkaW5nIFNjcmlwdCAoJy4ubWF0aC5yb3VuZCgxMDAvc2VsZi5TaXplKkRvd25sb2FkZWRTaXplLDIpLi4nJSknCiAgICBlbmQKICAgIAogIGVuZAogIAogIGlmIHNlbGYuRmlsZTpmaW5kKCc8L3NjcicuLidpcHQ+JykgdGhlbgogICAgc2VsZi5Eb3dubG9hZFN0YXR1cyA9ICdEb3dubG9hZGluZyBTY3JpcHQgKDEwMCUpJwogICAgCiAgICBsb2NhbCBhLGIgPSBzZWxmLkZpbGU6ZmluZCgnXHJcblxyXG4nKQogICAgCiAgICBzZWxmLkZpbGUgPSBzZWxmLkZpbGU6c3ViKGEsLTEpCiAgICBzZWxmLk5ld0ZpbGUgPSAnJwogICAgCiAgICBmb3IgbGluZSxjb250ZW50IGluIGlwYWlycyhzZWxmLkZpbGU6c3BsaXQoJ1xuJykpIGRvCiAgICAKICAgICAgaWYgY29udGVudDpsZW4oKSA+IDUgdGhlbgogICAgICAgIHNlbGYuTmV3RmlsZSA9IHNlbGYuTmV3RmlsZSAuLiBjb250ZW50CiAgICAgIGVuZAogICAgICAKICAgIGVuZAogICAgCiAgICBsb2NhbCBIZWFkZXJFbmQsIENvbnRlbnRTdGFydCA9IHNlbGYuTmV3RmlsZTpmaW5kKCc8c2MnLi4ncmlwdD4nKQogICAgbG9jYWwgQ29udGVudEVuZCwgXyA9IHNlbGYuTmV3RmlsZTpmaW5kKCc8L3NjcicuLidpcHQ+JykKICAgIAogICAgaWYgbm90IENvbnRlbnRTdGFydCBvciBub3QgQ29udGVudEVuZCB0aGVuCiAgICAgIAogICAgICBpZiBzZWxmLkNhbGxiYWNrRXJyb3IgYW5kIHR5cGUoc2VsZi5DYWxsYmFja0Vycm9yKSA9PSAnZnVuY3Rpb24nIHRoZW4KICAgICAgICBzZWxmLkNhbGxiYWNrRXJyb3IoKQogICAgICBlbmQKICAgICAgCiAgICBlbHNlCiAgICAgIAogICAgICBsb2NhbCBuZXdmID0gc2VsZi5OZXdGaWxlOnN1YihDb250ZW50U3RhcnQrMSxDb250ZW50RW5kLTEpCiAgICAgIGxvY2FsIG5ld2YgPSBuZXdmOmdzdWIoJ1xyJywnJykKICAgICAgCiAgICAgIGlmIG5ld2Y6bGVuKCkgfj0gc2VsZi5TaXplIHRoZW4KICAgICAgCiAgICAgICAgaWYgc2VsZi5DYWxsYmFja0Vycm9yIGFuZCB0eXBlKHNlbGYuQ2FsbGJhY2tFcnJvcikgPT0gJ2Z1bmN0aW9uJyB0aGVuCiAgICAgICAgICBzZWxmLkNhbGxiYWNrRXJyb3IoKQogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIHJldHVybgogICAgICBlbmQKICAgICAgCiAgICAgIGxvY2FsIG5ld2YgPSBCYXNlNjREZWNvZGUobmV3ZikKICAgICAgCiAgICAgIGlmIHR5cGUobG9hZChuZXdmKSkgfj0gJ2Z1bmN0aW9uJyB0aGVuCiAgICAgIAogICAgICAgIGlmIHNlbGYuQ2FsbGJhY2tFcnJvciBhbmQgdHlwZShzZWxmLkNhbGxiYWNrRXJyb3IpID09ICdmdW5jdGlvbicgdGhlbgogICAgICAgICAgc2VsZi5DYWxsYmFja0Vycm9yKCkKICAgICAgICBlbmQKICAgICAgICAKICAgICAgZWxzZQogICAgICAKICAgICAgICBsb2NhbCBmID0gaW8ub3BlbihzZWxmLlNhdmVQYXRoLCJ3K2IiKQogICAgICAgIAogICAgICAgIGY6d3JpdGUobmV3ZikKICAgICAgICBmOmNsb3NlKCkKICAgICAgICAKICAgICAgICBpZiBzZWxmLkNhbGxiYWNrVXBkYXRlIGFuZCB0eXBlKHNlbGYuQ2FsbGJhY2tVcGRhdGUpID09ICdmdW5jdGlvbicgdGhlbgogICAgICAgICAgc2VsZi5DYWxsYmFja1VwZGF0ZShzZWxmLk9ubGluZVZlcnNpb24sc2VsZi5Mb2NhbFZlcnNpb24pCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgIGVuZAogICAgICAKICAgIGVuZAogICAgCiAgICBzZWxmLkdvdFNjcmlwdFVwZGF0ZSA9IHRydWUKICBlbmQKICAKZW5kCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBPbkxvYWQoKQoKICBIVFRGX1Zpa3RvciA9IEhUVEZfVmlrdG9yKCkKICAKZW5kCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBIVFRGX1Zpa3RvcjpfX2luaXQoKQogIHNlbGY6VXBkYXRlKCkKICBzZWxmOlZhcmlhYmxlcygpCiAgc2VsZjpNZW51KCkKICAKICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHNlbGY6T3Jid2FsaygpIGVuZCwgMSkKICBBZGRUaWNrQ2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOlRpY2soKSBlbmQpCiAgQWRkRHJhd0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpEcmF3KCkgZW5kKQogIEFkZEFuaW1hdGlvbkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGFuaW1hdGlvbikgc2VsZjpBbmltYXRpb24odW5pdCwgYW5pbWF0aW9uKSBlbmQpCiAgQWRkQ3JlYXRlT2JqQ2FsbGJhY2soZnVuY3Rpb24ob2JqZWN0KSBzZWxmOkNyZWF0ZU9iaihvYmplY3QpIGVuZCkKICBBZGREZWxldGVPYmpDYWxsYmFjayhmdW5jdGlvbihvYmplY3QpIHNlbGY6RGVsZXRlT2JqKG9iamVjdCkgZW5kKQogIEFkZFByb2Nlc3NTcGVsbENhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIHNwZWxsKSBzZWxmOlByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkgZW5kKQplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gSFRURl9WaWt0b3I6VXBkYXRlKCkKCiAgbG9jYWwgVG9VcGRhdGUgPSB7fQogIAogIFRvVXBkYXRlLkhvc3QgPSAicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIKICBUb1VwZGF0ZS5WZXJzaW9uUGF0aCA9ICIvQm9sSFRURi9Cb0wvbWFzdGVyL0hUVEYvVmVyc2lvbi9IVFRGJTIwVmlrdG9yLnZlcnNpb24iCiAgVG9VcGRhdGUuU2NyaXB0UGF0aCA9ICAiL0JvbEhUVEYvQm9ML21hc3Rlci9IVFRGL0hUVEYlMjBWaWt0b3IubHVhIgogIFRvVXBkYXRlLlNhdmVQYXRoID0gU0NSSVBUX1BBVEggLi4gR2V0Q3VycmVudEVudigpLkZJTEVfTkFNRQogIFRvVXBkYXRlLkNhbGxiYWNrVXBkYXRlID0gZnVuY3Rpb24oTmV3VmVyc2lvbiwgT2xkVmVyc2lvbikgcHJpbnQoIjxmb250IGNvbG9yPVwiIzAwRkE5QVwiPjxiPltLZW4gVmlrdG9yXSA8L2I+PC9mb250PiA8Zm9udCBjb2xvcj1cIiMwMEZGMDBcIj5D4bqtcCBuaOG6rXQgdsOgbyAiLi5OZXdWZXJzaW9uLi4iLiA8L2I+PC9mb250PiIpIGVuZAogIFRvVXBkYXRlLkNhbGxiYWNrTm9VcGRhdGUgPSBmdW5jdGlvbihPbGRWZXJzaW9uKSBwcmludCgiPGZvbnQgY29sb3I9XCIjMDBGQTlBXCI+PGI+W0tlbiBWaWt0b3JdIDwvYj48L2ZvbnQ+IDxmb250IGNvbG9yPVwiIzAwRkYwMFwiPktow7RuZyB0w6xtIHRo4bqleSBj4bqtcCBuaOG6rXQ8L2I+PC9mb250PiIpIGVuZAogIFRvVXBkYXRlLkNhbGxiYWNrTmV3VmVyc2lvbiA9IGZ1bmN0aW9uKE5ld1ZlcnNpb24pIHByaW50KCI8Zm9udCBjb2xvcj1cIiMwMEZBOUFcIj48Yj5bS2VuIFZpa3Rvcl0gPC9iPjwvZm9udD4gPGZvbnQgY29sb3I9XCIjMDBGRjAwXCI+UGhpw6puIGLhuqNuIG3hu5tpIHTDrG0gdGjhuqV5ICgiLi5OZXdWZXJzaW9uLi4iKS4gSMOjeSBjaOG7nSBjaG8gxJHhur9uIGtoaSBuw7MgxJHGsOG7o2MgdOG6o2kgduG7gTwvYj48L2ZvbnQ+IikgZW5kCiAgVG9VcGRhdGUuQ2FsbGJhY2tFcnJvciA9IGZ1bmN0aW9uKE5ld1ZlcnNpb24pIHByaW50KCI8Zm9udCBjb2xvcj1cIiMwMEZBOUFcIj48Yj5bS2VuIFZpa3Rvcl0gPC9iPjwvZm9udD4gPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+TOG7l2kga2hpIHThuqNpIHbhu4EuIFZ1aSBsw7JuZyB0aOG7rSBs4bqhaS48L2I+PC9mb250PiIpIGVuZAogIFNjcmlwdFVwZGF0ZShWZXJzaW9uLCB0cnVlLCBUb1VwZGF0ZS5Ib3N0LCBUb1VwZGF0ZS5WZXJzaW9uUGF0aCwgVG9VcGRhdGUuU2NyaXB0UGF0aCwgVG9VcGRhdGUuU2F2ZVBhdGgsIFRvVXBkYXRlLkNhbGxiYWNrVXBkYXRlLFRvVXBkYXRlLkNhbGxiYWNrTm9VcGRhdGUsIFRvVXBkYXRlLkNhbGxiYWNrTmV3VmVyc2lvbixUb1VwZGF0ZS5DYWxsYmFja0Vycm9yKQplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIEhUVEZfVmlrdG9yOlZhcmlhYmxlcygpCgogIHNlbGYuSFByZWQgPSBIUHJlZGljdGlvbigpCiAgLS1zZWxmLkhQcmVkX1cgPSBIUFNraWxsc2hvdCh7dHlwZSA9ICJQcm9tcHRDaXJjbGUiLCBkZWxheSA9IDEtLVtbMS41XV0rMC42LCByYW5nZSA9IDcwMCwgcmFkaXVzID0gZnVuY3Rpb24oKSByZXR1cm4gMzI1KigxMDAvKDEwMC0oNCpzZWxmOkxldmVsKF9XKSsyNCkpKSBlbmQsIElzVmVyeUxvd0FjY3VyYWN5ID0gdHJ1ZX0pCiAgc2VsZi5IUHJlZF9SID0gSFBTa2lsbHNob3Qoe3R5cGUgPSAiUHJvbXB0Q2lyY2xlIiwgZGVsYXkgPSAwLjI3LCByYW5nZSA9IDcwMCwgcmFkaXVzID0gMzI1fSkKICAKICBzZWxmLklzUmVjYWxsID0gZmFsc2UKICBzZWxmLkxhc3RGb2xsb3cgPSAwCiAgc2VsZi5MYXN0RmFybUUgPSAwCiAgc2VsZi5MYXN0SkZhcm1FID0gMAogIHNlbGYuTGFzdFJUYXJnZXQgPSBuaWwKICBzZWxmLlJlYm9ybkxvYWRlZCwgc2VsZi5SZXZhbXBlZExvYWRlZCwgc2VsZi5NTUFMb2FkZWQsIHNlbGYuU3hPcmJMb2FkZWQsIHNlbGYuU09XTG9hZGVkID0gZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlCiAgc2VsZi5TdG9ybSA9IG5pbAogIAogIGlmIG15SGVybzpHZXRTcGVsbERhdGEoU1VNTU9ORVJfMSkubmFtZTpmaW5kKCJzdW1tb25lcmRvdCIpIHRoZW4KICAgIHNlbGYuSWduaXRlID0gU1VNTU9ORVJfMQogIGVsc2VpZiBteUhlcm86R2V0U3BlbGxEYXRhKFNVTU1PTkVSXzIpLm5hbWU6ZmluZCgic3VtbW9uZXJkb3QiKSB0aGVuCiAgICBzZWxmLklnbml0ZSA9IFNVTU1PTkVSXzIKICBlbmQKICAKICBpZiBteUhlcm86R2V0U3BlbGxEYXRhKFNVTU1PTkVSXzEpLm5hbWU6ZmluZCgic21pdGUiKSB0aGVuCiAgICBzZWxmLlNtaXRlID0gU1VNTU9ORVJfMQogIGVsc2VpZiBteUhlcm86R2V0U3BlbGxEYXRhKFNVTU1PTkVSXzIpLm5hbWU6ZmluZCgic21pdGUiKSB0aGVuCiAgICBzZWxmLlNtaXRlID0gU1VNTU9ORVJfMgogIGVuZAogIAogIHNlbGYuUSA9IHtyYW5nZSA9IDcwMCwgcmVhZHl9CiAgc2VsZi5XID0ge3JhbmdlID0gNzAwLCByYWRpdXMgPSAzMjUsIHJlYWR5fQogIHNlbGYuRSA9IHtyYW5nZTEgPSA1NTAsIHJhbmdlMiA9IDcwMCwgd2lkdGggPSAxNjAsIHJlYWR5fQogIHNlbGYuUiA9IHtyYW5nZSA9IDcwMCwgcmFkaXVzID0gMzI1LCByZWFkeX0KICBzZWxmLkkgPSB7cmFuZ2UgPSA2MDAsIHJlYWR5fQogIHNlbGYuUyA9IHtyYW5nZSA9IDc2MCwgcmVhZHl9CiAgCiAgc2VsZi5FUmFuZ2UgPSBzZWxmLkUucmFuZ2UxK3NlbGYuRS5yYW5nZTIKICAKICBsb2NhbCBTNVNSID0gZmFsc2UKICBsb2NhbCBUVCA9IGZhbHNlCiAgCiAgaWYgR2V0R2FtZSgpLm1hcC5pbmRleCA9PSAxNSB0aGVuCiAgICBTNVNSID0gdHJ1ZQogIGVsc2VpZiBHZXRHYW1lKCkubWFwLmluZGV4ID09IDQgdGhlbgogICAgVFQgPSB0cnVlCiAgZW5kCiAgCiAgaWYgUzVTUiB0aGVuCiAgICBzZWxmLkZvY3VzSnVuZ2xlTmFtZXMgPQogICAgewogICAgIlNSVV9CYXJvbjEyLjEuMSIsCiAgICAiU1JVX0JsdWUxLjEuMSIsCiAgICAiU1JVX0JsdWU3LjEuMSIsCiAgICAiU3J1X0NyYWIxNS4xLjEiLAogICAgIlNydV9DcmFiMTYuMS4xIiwKICAgICJTUlVfRHJhZ29uNi4xLjEiLAogICAgIlNSVV9Hcm9tcDEzLjEuMSIsCiAgICAiU1JVX0dyb21wMTQuMS4xIiwKICAgICJTUlVfS3J1ZzUuMS4yIiwKICAgICJTUlVfS3J1ZzExLjEuMiIsCiAgICAiU1JVX011cmt3b2xmMi4xLjEiLAogICAgIlNSVV9NdXJrd29sZjguMS4xIiwKICAgICJTUlVfUmF6b3JiZWFrMy4xLjEiLAogICAgIlNSVV9SYXpvcmJlYWs5LjEuMSIsCiAgICAiU1JVX1JlZDQuMS4xIiwKICAgICJTUlVfUmVkMTAuMS4xIgogICAgfQogICAgc2VsZi5KdW5nbGVNb2JOYW1lcyA9CiAgICB7CiAgICAiU1JVX0JsdWVNaW5pMS4xLjIiLAogICAgIlNSVV9CbHVlTWluaTcuMS4yIiwKICAgICJTUlVfQmx1ZU1pbmkyMS4xLjMiLAogICAgIlNSVV9CbHVlTWluaTI3LjEuMyIsCiAgICAiU1JVX0tydWdNaW5pNS4xLjEiLAogICAgIlNSVV9LcnVnTWluaTExLjEuMSIsCiAgICAiU1JVX011cmt3b2xmTWluaTIuMS4yIiwKICAgICJTUlVfTXVya3dvbGZNaW5pMi4xLjMiLAogICAgIlNSVV9NdXJrd29sZk1pbmk4LjEuMiIsCiAgICAiU1JVX011cmt3b2xmTWluaTguMS4zIiwKICAgICJTUlVfUmF6b3JiZWFrTWluaTMuMS4yIiwKICAgICJTUlVfUmF6b3JiZWFrTWluaTMuMS4zIiwKICAgICJTUlVfUmF6b3JiZWFrTWluaTMuMS40IiwKICAgICJTUlVfUmF6b3JiZWFrTWluaTkuMS4yIiwKICAgICJTUlVfUmF6b3JiZWFrTWluaTkuMS4zIiwKICAgICJTUlVfUmF6b3JiZWFrTWluaTkuMS40IiwKICAgICJTUlVfUmVkTWluaTQuMS4yIiwKICAgICJTUlVfUmVkTWluaTQuMS4zIiwKICAgICJTUlVfUmVkTWluaTEwLjEuMiIsCiAgICAiU1JVX1JlZE1pbmkxMC4xLjMiCiAgICB9CiAgZWxzZWlmIFRUIHRoZW4KICAgIHNlbGYuRm9jdXNKdW5nbGVOYW1lcyA9CiAgICB7CiAgICAiVFRfTldyYWl0aDEuMS4xIiwKICAgICJUVF9OR29sZW0yLjEuMSIsCiAgICAiVFRfTldvbGYzLjEuMSIsCiAgICAiVFRfTldyYWl0aDQuMS4xIiwKICAgICJUVF9OR29sZW01LjEuMSIsCiAgICAiVFRfTldvbGY2LjEuMSIsCiAgICAiVFRfU3BpZGVyYm9zczguMS4xIgogICAgfSAgIAogICAgc2VsZi5KdW5nbGVNb2JOYW1lcyA9CiAgICB7CiAgICAiVFRfTldyYWl0aDIxLjEuMiIsCiAgICAiVFRfTldyYWl0aDIxLjEuMyIsCiAgICAiVFRfTkdvbGVtMjIuMS4yIiwKICAgICJUVF9OV29sZjIzLjEuMiIsCiAgICAiVFRfTldvbGYyMy4xLjMiLAogICAgIlRUX05XcmFpdGgyNC4xLjIiLAogICAgIlRUX05XcmFpdGgyNC4xLjMiLAogICAgIlRUX05Hb2xlbTI1LjEuMSIsCiAgICAiVFRfTldvbGYyNi4xLjIiLAogICAgIlRUX05Xb2xmMjYuMS4zIgogICAgfQogIGVsc2UKICAgIHNlbGYuRm9jdXNKdW5nbGVOYW1lcyA9CiAgICB7CiAgICB9ICAgCiAgICBzZWxmLkp1bmdsZU1vYk5hbWVzID0KICAgIHsKICAgIH0KICBlbmQKICAKICBzZWxmLlFUUyA9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1QsIHNlbGYuUS5yYW5nZSwgREFNQUdFX01BR0lDLCBmYWxzZSkKICBzZWxmLldUUyA9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9DTE9TRVNULCBzZWxmLlcucmFuZ2UsIERBTUFHRV9NQUdJQywgZmFsc2UpCiAgc2VsZi5FVFMgPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNULCBzZWxmLkVSYW5nZSwgREFNQUdFX01BR0lDLCBmYWxzZSkKICBzZWxmLlNUUyA9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MT1dfSFAsIHNlbGYuUy5yYW5nZSkKICAKICBzZWxmLkVuZW15SGVyb2VzID0gR2V0RW5lbXlIZXJvZXMoKQogIHNlbGYuc0VuZW15TWluaW9ucyA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0VORU1ZLCBzZWxmLkUucmFuZ2UxLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpCiAgc2VsZi5lY0VuZW15TWluaW9ucyA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0VORU1ZLCBzZWxmLkVSYW5nZSszMDAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykKICBzZWxmLkp1bmdsZU1vYnMgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9KVU5HTEUsIHNlbGYuRVJhbmdlLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpCiAgCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBIVFRGX1Zpa3RvcjpNZW51KCkKCiAgc2VsZi5NZW51ID0gc2NyaXB0Q29uZmlnKCJLZW4gVmlrdG9yIiwgIktlbiBWaWt0b3IiKQogIAogIHNlbGYuTWVudTphZGRTdWJNZW51KCJDYWkgZGF0IEhpdENoYW5jZSIsICJIaXRDaGFuY2UiKQogIAogICAgc2VsZi5NZW51LkhpdENoYW5jZTphZGRTdWJNZW51KCJDb21ibyIsICJDb21ibyIpCiAgICAgIHNlbGYuTWVudS5IaXRDaGFuY2UuQ29tYm86YWRkUGFyYW0oIldXIiwgIlcgSGl0Q2hhY25lIChEZWZhdWx0IHZhbHVlID0gMS43KSIsIFNDUklQVF9QQVJBTV9TTElDRSwgMS43LCAxLCAzLCAyKQogICAgICBzZWxmLk1lbnUuSGl0Q2hhbmNlLkNvbWJvOmFkZFBhcmFtKCJFIiwgIkUgSGl0Q2hhY25lIChEZWZhdWx0IHZhbHVlID0gMS42KSIsIFNDUklQVF9QQVJBTV9TTElDRSwgMS42LCAxLCAzLCAyKQogICAgICBzZWxmLk1lbnUuSGl0Q2hhbmNlLkNvbWJvOmFkZFBhcmFtKCJSIiwgIlIgSGl0Q2hhY25lIChEZWZhdWx0IHZhbHVlID0gMykiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMsIDIsIDMsIDIpCiAgICAgIAogICAgc2VsZi5NZW51LkhpdENoYW5jZTphZGRTdWJNZW51KCJIYXJhc3MiLCAiSGFyYXNzIikKICAgICAgc2VsZi5NZW51LkhpdENoYW5jZS5IYXJhc3M6YWRkUGFyYW0oIkUiLCAiRSBIaXRDaGFjbmUgKERlZmF1bHQgdmFsdWUgPSAyKSIsIFNDUklQVF9QQVJBTV9TTElDRSwgMiwgMSwgMywgMikKICAgICAgCiAgc2VsZi5NZW51OmFkZFN1Yk1lbnUoIkNhaSBEYXQgQ29tYm8iLCAiQ29tYm8iKQogICAgc2VsZi5NZW51LkNvbWJvOmFkZFBhcmFtKCJPbiIsICJDb21ibyIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCAzMikKICAgIHNlbGYuTWVudS5Db21ibzphZGRQYXJhbSgiQmxhbmsiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKQogICAgc2VsZi5NZW51LkNvbWJvOmFkZFBhcmFtKCJRIiwgIlVzZSBRIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQogICAgc2VsZi5NZW51LkNvbWJvOmFkZFBhcmFtKCJCbGFuayIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywgIiIpCiAgICBzZWxmLk1lbnUuQ29tYm86YWRkUGFyYW0oIlciLCAiVXNlIFciLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCiAgICBzZWxmLk1lbnUuQ29tYm86YWRkUGFyYW0oIlcyIiwgIlVzZSBXIE5ldSBNYW5hIFBoYW4gVHJhbSA+IHglICgyNSkiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIDI1LCAwLCAxMDAsIDApCiAgICBzZWxmLk1lbnUuQ29tYm86YWRkUGFyYW0oIkJsYW5rIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCAiIikKICAgIHNlbGYuTWVudS5Db21ibzphZGRQYXJhbSgiRSIsICJVc2UgRSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkKICAgIHNlbGYuTWVudS5Db21ibzphZGRQYXJhbSgiQmxhbmsiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKQogICAgc2VsZi5NZW51LkNvbWJvOmFkZFBhcmFtKCJSIiwgIlVzZSBSIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQogICAgc2VsZi5NZW51LkNvbWJvOmFkZFBhcmFtKCJSMiIsICJLaG9hZyBUaG9pIEdpYW4gQ2h1eWVuIERvbmcgUiAoMC4zKSIsIFNDUklQVF9QQVJBTV9TTElDRSwgLjMsIDAsIDEsIDEpCiAgICAKICBzZWxmLk1lbnU6YWRkU3ViTWVudSgiQ2FpIGRhdCBDbGVhciIsICJDbGVhciIpCiAgCiAgICBzZWxmLk1lbnUuQ2xlYXI6YWRkU3ViTWVudSgiQ2FpIGRhdCBMYW5lIENsZWFyIiwgIkZhcm0iKQogICAgICBzZWxmLk1lbnUuQ2xlYXIuRmFybTphZGRQYXJhbSgiT24iLCAiTGFuZSBDbGVhciIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBHZXRLZXkoJ1YnKSkKICAgICAgc2VsZi5NZW51LkNsZWFyLkZhcm06YWRkUGFyYW0oIkJsYW5rIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCAiIikKICAgICAgc2VsZi5NZW51LkNsZWFyLkZhcm06YWRkUGFyYW0oIlEiLCAiVXNlIFEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCiAgICAgIHNlbGYuTWVudS5DbGVhci5GYXJtOmFkZFBhcmFtKCJRMiIsICJVc2UgUSBOZXUgbWFuYSBwaGFuIHRyYW0gPiB4JSAoMzApIiwgU0NSSVBUX1BBUkFNX1NMSUNFLCAzMCwgMCwgMTAwLCAwKQogICAgICBzZWxmLk1lbnUuQ2xlYXIuRmFybTphZGRQYXJhbSgiUTMiLCAiVXNlIFEgaWYgQUEgY29vbCBkb3duIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQogICAgICBzZWxmLk1lbnUuQ2xlYXIuRmFybTphZGRQYXJhbSgiUTQiLCAiVXNlIFEgQ2hpIGNobyBoaXQgY3VvaSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkKICAgICAgc2VsZi5NZW51LkNsZWFyLkZhcm06YWRkUGFyYW0oIkJsYW5rIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCAiIikKICAgICAgc2VsZi5NZW51LkNsZWFyLkZhcm06YWRkUGFyYW0oIkUiLCAiVXNlIEUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCiAgICAgIHNlbGYuTWVudS5DbGVhci5GYXJtOmFkZFBhcmFtKCJJbmZvIiwgIlNtYXJ0IEUgbWFuYSBtYW5hZ2VyIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKQogICAgICBzZWxmLk1lbnUuQ2xlYXIuRmFybTphZGRQYXJhbSgiRU1pbiIsICJNaW4gZW5lbWllcyBmb3IgRSAoMykiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMsIDIsIDEyLCAwKQogICAgICAKICAgIHNlbGYuTWVudS5DbGVhcjphZGRTdWJNZW51KCJKdW5nbGUgQ2xlYXIgU2V0dGluZ3MiLCAiSkZhcm0iKQogICAgICBzZWxmLk1lbnUuQ2xlYXIuSkZhcm06YWRkUGFyYW0oIk9uIiwgIkp1bmdsZSBDbGVhciIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBHZXRLZXkoJ1YnKSkKICAgICAgc2VsZi5NZW51LkNsZWFyLkpGYXJtOmFkZFBhcmFtKCJCbGFuayIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywgIiIpCiAgICAgIHNlbGYuTWVudS5DbGVhci5KRmFybTphZGRQYXJhbSgiUSIsICJVc2UgUSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkKICAgICAgc2VsZi5NZW51LkNsZWFyLkpGYXJtOmFkZFBhcmFtKCJCbGFuayIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywgIiIpCiAgICAgIHNlbGYuTWVudS5DbGVhci5KRmFybTphZGRQYXJhbSgiRSIsICJVc2UgRSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkKICAgICAgCiAgc2VsZi5NZW51OmFkZFN1Yk1lbnUoIkNhaSBkYXQgSGFyYXNzIiwgIkhhcmFzcyIpCiAgICBzZWxmLk1lbnUuSGFyYXNzOmFkZFBhcmFtKCJPbiIsICJIYXJhc3MiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgR2V0S2V5KCdDJykpCiAgICBzZWxmLk1lbnUuSGFyYXNzOmFkZFBhcmFtKCJPbjIiLCAiSGFyYXNzIFRvZ2dsZSIsIFNDUklQVF9QQVJBTV9PTktFWVRPR0dMRSwgZmFsc2UsIEdldEtleSgnSCcpKQogICAgc2VsZi5NZW51LkhhcmFzczphZGRQYXJhbSgiQmxhbmsiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKQogICAgc2VsZi5NZW51LkhhcmFzczphZGRQYXJhbSgiUSIsICJVc2UgUSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkKICAgIHNlbGYuTWVudS5IYXJhc3M6YWRkUGFyYW0oIkJsYW5rIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCAiIikKICAgIHNlbGYuTWVudS5IYXJhc3M6YWRkUGFyYW0oIkUiLCAiVXNlIEUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCiAgICAKICBzZWxmLk1lbnU6YWRkU3ViTWVudSgiQ2FpIGRhdCBMYXN0SGl0IiwgIkxhc3RIaXQiKQogICAgc2VsZi5NZW51Lkxhc3RIaXQ6YWRkUGFyYW0oIk9uIiwgIkxhc3RIaXQiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgR2V0S2V5KCdYJykpCiAgICBzZWxmLk1lbnUuTGFzdEhpdDphZGRQYXJhbSgiQmxhbmsiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKQogICAgc2VsZi5NZW51Lkxhc3RIaXQ6YWRkUGFyYW0oIlEiLCAiVXNlIFEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCiAgICBzZWxmLk1lbnUuTGFzdEhpdDphZGRQYXJhbSgiUTIiLCAiVXNlIFEgaWYgTWFuYSBQZXJjZW50ID4geCUgKDc1KSIsIFNDUklQVF9QQVJBTV9TTElDRSwgNzUsIDAsIDEwMCwgMCkKICAgIAogIGlmIHNlbGYuU21pdGUgfj0gbmlsIHRoZW4KICBzZWxmLk1lbnU6YWRkU3ViTWVudSgiQ2FpIGRhdCBKdW5nbGUgU3RlYWwiLCAiSlN0ZWFsIikKICAgIHNlbGYuTWVudS5KU3RlYWw6YWRkUGFyYW0oIk9uIiwgIkp1bmdsZSBTdGVhbCIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBHZXRLZXkoJ1gnKSkKICAgIHNlbGYuTWVudS5KU3RlYWw6YWRkUGFyYW0oIk9uMiIsICJKdW5nbGUgU3RlYWwgVG9nZ2xlIiwgU0NSSVBUX1BBUkFNX09OS0VZVE9HR0xFLCB0cnVlLCBHZXRLZXkoJ04nKSkKICAgIHNlbGYuTWVudS5KU3RlYWw6YWRkUGFyYW0oIkJsYW5rIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCAiIikKICAgIHNlbGYuTWVudS5KU3RlYWw6YWRkUGFyYW0oIlMiLCAiVXNlIFNtaXRlIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQogICAgc2VsZi5NZW51LkpTdGVhbDphZGRQYXJhbSgiQmxhbmsiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKQogICAgc2VsZi5NZW51LkpTdGVhbDphZGRQYXJhbSgiQWx3YXlzIiwgIkFsd2F5cyBVc2UgU21pdGVcbihCYXJvbiAmIERyYWdvbikiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCiAgZW5kCiAgCiAgc2VsZi5NZW51OmFkZFN1Yk1lbnUoIkNhaSBkYXQgQXV0byBEaWUgTXVjIFRpZXUiLCAiS2lsbFN0ZWFsIikKICAgIHNlbGYuTWVudS5LaWxsU3RlYWw6YWRkUGFyYW0oIk9uIiwgIkt5IG5hbmcgdHUgZG9uZyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkKICAgIHNlbGYuTWVudS5LaWxsU3RlYWw6YWRkUGFyYW0oIkJsYW5rIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCAiIikKICAgIHNlbGYuTWVudS5LaWxsU3RlYWw6YWRkUGFyYW0oIlEiLCAiVXNlIFEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCiAgICBzZWxmLk1lbnUuS2lsbFN0ZWFsOmFkZFBhcmFtKCJFIiwgIlVzZSBFIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQogICAgc2VsZi5NZW51LktpbGxTdGVhbDphZGRQYXJhbSgiUiIsICJVc2UgUiIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkKICAgIGlmIHNlbGYuSWduaXRlIH49IG5pbCB0aGVuCiAgICBzZWxmLk1lbnUuS2lsbFN0ZWFsOmFkZFBhcmFtKCJCbGFuayIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywgIiIpCiAgICBzZWxmLk1lbnUuS2lsbFN0ZWFsOmFkZFBhcmFtKCJJIiwgIlVzZSBJZ25pdGUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCiAgICBlbmQKICAgIGlmIHNlbGYuU21pdGUgfj0gbmlsIHRoZW4KICAgIHNlbGYuTWVudS5LaWxsU3RlYWw6YWRkUGFyYW0oIkJsYW5rNCIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywgIiIpCiAgICBzZWxmLk1lbnUuS2lsbFN0ZWFsOmFkZFBhcmFtKCJTIiwgIlVzZSBTdGFsa2VyJ3MgQmxhZGUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCiAgICBlbmQKICAgIAogIHNlbGYuTWVudTphZGRTdWJNZW51KCJDYWkgRGF0IEZsZWUiLCAiRmxlZSIpCiAgICBzZWxmLk1lbnUuRmxlZTphZGRQYXJhbSgiT24iLCAiVHJvbiIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBHZXRLZXkoJ0cnKSkKICAgIAogIGlmIFZJUF9VU0VSIHRoZW4KICBzZWxmLk1lbnU6YWRkU3ViTWVudSgiTWlzYyIsICJNaXNjIikKICAgIHNlbGYuTWVudS5NaXNjOmFkZFBhcmFtKCJCbG9ja1IiLCAiS2hvYSBSIG5ldSBraG9uZyB0cnVuZyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkKICBlbmQKICAKICBzZWxmLk1lbnU6YWRkU3ViTWVudSgiQ2FpIGRhdCBwaGFtIHZpIiwgIkRyYXciKQogIAogICAgc2VsZi5NZW51LkRyYXc6YWRkU3ViTWVudSgiUGhhbSB2aSBNdWMgVGlldSIsICJUYXJnZXQiKQogICAgICBzZWxmLk1lbnUuRHJhdy5UYXJnZXQ6YWRkUGFyYW0oIlEiLCAiVGFtIFEgTXVjIFRpZXUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQogICAgICBzZWxmLk1lbnUuRHJhdy5UYXJnZXQ6YWRkUGFyYW0oIlciLCAiVGFtIFcsIFIgTXVjIFRpZXUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQogICAgICBzZWxmLk1lbnUuRHJhdy5UYXJnZXQ6YWRkUGFyYW0oIkUiLCAiVGFtIEUgTXVjIFRpZXUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCiAgICAgIAogICAgc2VsZi5NZW51LkRyYXc6YWRkU3ViTWVudSgiVGFtIFZpIFRyaSBkdSBkb2FuICYgTGluZSIsICJQUCIpCiAgICAgIHNlbGYuTWVudS5EcmF3LlBQOmFkZFBhcmFtKCJFIiwgIlBoYW0gVmkgRSBMaW5lIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQogICAgICBzZWxmLk1lbnUuRHJhdy5QUDphZGRQYXJhbSgiQmxhbmsiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKQogICAgICBzZWxmLk1lbnUuRHJhdy5QUDphZGRQYXJhbSgiTGluZSIsICJUYW0gTGluZSB0byBQb3MiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCiAgICAgIHNlbGYuTWVudS5EcmF3OmFkZFBhcmFtKCJCbGFuayIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywgIiIpCiAgICAgICAgCiAgICBzZWxmLk1lbnUuRHJhdzphZGRQYXJhbSgiT24iLCAiVGFtIEt5IE5hbmciLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCiAgICBzZWxmLk1lbnUuRHJhdzphZGRQYXJhbSgiQmxhbmsiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKQogICAgc2VsZi5NZW51LkRyYXc6YWRkUGFyYW0oIkxmYyIsICJHaWFtIExhZyBWb25nIFRyb24iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpCiAgICBzZWxmLk1lbnUuRHJhdzphZGRQYXJhbSgiQmxhbmsiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKQogICAgc2VsZi5NZW51LkRyYXc6YWRkUGFyYW0oIkFBIiwgIkhpZW4gVGhpIFRhbSBQaGFtIHZpIHRhbiBjb25nIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkKICAgIHNlbGYuTWVudS5EcmF3OmFkZFBhcmFtKCJRIiwgIkhpZW4gVGhpIFRhbSBQaGFtIHZpIFEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQogICAgc2VsZi5NZW51LkRyYXc6YWRkUGFyYW0oIlciLCAiSGllbiBUaGkgVGFtIFBoYW0gdmkgVyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgZmFsc2UpCiAgICBzZWxmLk1lbnUuRHJhdzphZGRQYXJhbSgiRSIsICJIaWVuIFRoaSBUYW0gUGhhbSB2aSBFIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQogICAgc2VsZi5NZW51LkRyYXc6YWRkUGFyYW0oIlIiLCAiSGllbiBUaGkgVGFtIFBoYW0gdmkgUiIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkKICAgIGlmIHNlbGYuSWduaXRlIH49IG5pbCB0aGVuCiAgICBzZWxmLk1lbnUuRHJhdzphZGRQYXJhbSgiQmxhbmsiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKQogICAgc2VsZi5NZW51LkRyYXc6YWRkUGFyYW0oIkkiLCAiSGllbiB0aGkgcGhhbSB2aSBJZ25pdGUgcmFuZ2UiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQogICAgZW5kCiAgICBpZiBzZWxmLlNtaXRlIH49IG5pbCB0aGVuCiAgICBzZWxmLk1lbnUuRHJhdzphZGRQYXJhbSgiQmxhbmsiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKQogICAgc2VsZi5NZW51LkRyYXc6YWRkUGFyYW0oIlMiLCAiSGllbiB0aGkgcGhhbSB2aSBTbWl0ZSByYW5nZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkKICAgIGVuZAogICAgc2VsZi5NZW51LkRyYXc6YWRkUGFyYW0oIkJsYW5rIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCAiIikKICAgIHNlbGYuTWVudS5EcmF3OmFkZFBhcmFtKCJQYXRoIiwgIkhpZW4gdGhpIHBoYW0gdmkgTW92ZSBQYXRoIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkKICAgIHNlbGYuTWVudS5EcmF3OmFkZFBhcmFtKCJCbGFuayIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywgIiIpCiAgICBzZWxmLk1lbnUuRHJhdzphZGRQYXJhbSgiSGl0Y2hhbmNlIiwgIkhpZW4gdGhpIHBoYW0gdmkgSGl0Y2hhbmNlIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQogICAgCiAgc2VsZi5NZW51LkNvbWJvLk9uID0gZmFsc2UKICBzZWxmLk1lbnUuQ2xlYXIuRmFybS5PbiA9IGZhbHNlCiAgc2VsZi5NZW51LkNsZWFyLkpGYXJtLk9uID0gZmFsc2UKICBzZWxmLk1lbnUuSGFyYXNzLk9uID0gZmFsc2UKICBzZWxmLk1lbnUuSGFyYXNzLk9uMiA9IGZhbHNlCiAgc2VsZi5NZW51Lkxhc3RIaXQuT24gPSBmYWxzZQogIGlmIHNlbGYuU21pdGUgfj0gbmlsIHRoZW4KICBzZWxmLk1lbnUuSlN0ZWFsLk9uID0gZmFsc2UKICBlbmQKICBzZWxmLk1lbnUuRmxlZS5PbiA9IGZhbHNlCiAgCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBIVFRGX1Zpa3RvcjpPcmJ3YWxrKCkKCiAgaWYgX0cuQXV0b0NhcnJ5IHRoZW4KICAKICAgIGlmIF9HLlJlYm9ybl9Jbml0aWFsaXNlZCB0aGVuCiAgICAgIHNlbGYuUmVib3JuTG9hZGVkID0gdHJ1ZQogICAgICBzZWxmOlNjcmlwdE1zZygiVMOsbSB0aOG6pXkgU0FDOiBSZWJvcm4uIikKICAgIGVsc2UKICAgICAgc2VsZi5SZXZhbXBlZExvYWRlZCA9IHRydWUKICAgICAgc2VsZjpTY3JpcHRNc2coIlTDrG0gdGjhuqV5IFNBQzogUmV2YW1wZWQuIikKICAgIGVuZAogICAgCiAgZWxzZWlmIF9HLlJlYm9ybl9Mb2FkZWQgdGhlbgogICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBzZWxmOk9yYndhbGsoKSBlbmQsIDEpCiAgZWxzZWlmIF9HLk1NQV9Jc0xvYWRlZCB0aGVuCiAgICBzZWxmLk1NQUxvYWRlZCA9IHRydWUKICAgIHNlbGY6U2NyaXB0TXNnKCJUw6xtIHRo4bqleSBNTUEuIikKICBlbHNlaWYgRmlsZUV4aXN0KExJQl9QQVRIIC4uICJTeE9yYldhbGsubHVhIikgdGhlbgogIAogICAgcmVxdWlyZSAnU3hPcmJXYWxrJwogICAgCiAgICBzZWxmLlN4T3JiTWVudSA9IHNjcmlwdENvbmZpZygiQ2FpIGRhdCBTeE9yYiIsICJTeE9yYiIpCiAgICAKICAgIHNlbGYuU3hPcmIgPSBTeE9yYldhbGsoKQogICAgc2VsZi5TeE9yYjpMb2FkVG9NZW51KHNlbGYuU3hPcmJNZW51KQogICAgCiAgICBzZWxmLlN4T3JiTG9hZGVkID0gdHJ1ZQogICAgc2VsZjpTY3JpcHRNc2coIlTDrG0gdGjhuqV5IFN4T3JiLiIpCiAgZWxzZWlmIEZpbGVFeGlzdChMSUJfUEFUSCAuLiAiU09XLmx1YSIpIHRoZW4KICAKICAgIHJlcXVpcmUgJ1NPVycKICAgIHJlcXVpcmUgJ1ZQcmVkaWN0aW9uJwogICAgCiAgICBzZWxmLlZQID0gVlByZWRpY3Rpb24oKQogICAgc2VsZi5TT1dWUCA9IFNPVyhzZWxmLlZQKQogICAgCiAgICBzZWxmLk1lbnU6YWRkU3ViTWVudSgiT3Jid2FsayBTZXR0aW5ncyAoU09XKSIsICJPcmJ3YWxrIikKICAgICAgc2VsZi5NZW51Lk9yYndhbGs6YWRkUGFyYW0oIkluZm8iLCAiU09XIHNldHRpbmdzIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKQogICAgICBzZWxmLk1lbnUuT3Jid2FsazphZGRQYXJhbSgiQmxhbmsiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKQogICAgICBzZWxmLlNPV1ZQOkxvYWRUb01lbnUoc2VsZi5NZW51Lk9yYndhbGspCiAgICAgIAogICAgc2VsZi5TT1dMb2FkZWQgPSB0cnVlCiAgICBzZWxmOlNjcmlwdE1zZygiVMOsbSB0aOG6pXkgU09XLiIpCiAgZWxzZQogICAgc2VsZjpTY3JpcHRNc2coIk9yYndhbGsga2jDtG5nIHRow6BuaCBs4bqtcC4iKQogIGVuZAogIAplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIEhUVEZfVmlrdG9yOlRpY2soKQoKICBpZiBteUhlcm8uZGVhZCB0aGVuCiAgICByZXR1cm4KICBlbmQKICAKICBzZWxmOkNoZWNrcygpCiAgc2VsZjpUYXJnZXRzKCkKICAKICBpZiBzZWxmOlJlYWR5KF9SKSBhbmQgb3MuY2xvY2soKS1zZWxmLkxhc3RGb2xsb3cgPiBzZWxmLk1lbnUuQ29tYm8uUjIgdGhlbgogICAgc2VsZjpGb2xsb3coKQogIGVuZAogIAogIGlmIHNlbGYuTWVudS5Db21iby5PbiB0aGVuCiAgICBzZWxmOkNvbWJvKCkKICBlbmQKICAKICBpZiBzZWxmLk1lbnUuQ2xlYXIuRmFybS5PbiB0aGVuCiAgICBzZWxmOkZhcm0oKQogIGVuZAogIAogIGlmIHNlbGYuTWVudS5DbGVhci5KRmFybS5PbiB0aGVuCiAgICBzZWxmOkpGYXJtKCkKICBlbmQKICAKICBpZiBzZWxmLk1lbnUuSGFyYXNzLk9uIG9yIChzZWxmLk1lbnUuSGFyYXNzLk9uMiBhbmQgbm90IHNlbGYuSXNSZWNhbGwpIHRoZW4KICAgIHNlbGY6SGFyYXNzKCkKICBlbmQKICAKICBpZiBzZWxmLk1lbnUuTGFzdEhpdC5PbiB0aGVuCiAgICBzZWxmOkxhc3RIaXQoKQogIGVuZAogIAogIGlmIHNlbGYuU21pdGUgfj0gbmlsIGFuZCAoc2VsZi5NZW51LkpTdGVhbC5PbiBvciBzZWxmLk1lbnUuSlN0ZWFsLk9uMikgdGhlbgogICAgc2VsZjpKU3RlYWwoKQogIGVuZAogIAogIGlmIHNlbGYuU21pdGUgfj0gbmlsIGFuZCBzZWxmLk1lbnUuSlN0ZWFsLkFsd2F5cyB0aGVuCiAgICBzZWxmOkpzdGVhbEFsd2F5cygpCiAgZW5kCiAgCiAgaWYgc2VsZi5NZW51LktpbGxTdGVhbC5PbiB0aGVuCiAgICBzZWxmOktpbGxTdGVhbCgpCiAgZW5kCiAgCiAgaWYgc2VsZi5NZW51LkZsZWUuT24gdGhlbgogICAgc2VsZjpGbGVlKCkKICBlbmQKICAKZW5kCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIEhUVEZfVmlrdG9yOkNoZWNrcygpCgogIHNlbGYuc0VuZW15TWluaW9uczp1cGRhdGUoKQogIHNlbGYuZWNFbmVteU1pbmlvbnM6dXBkYXRlKCkKICBzZWxmLkp1bmdsZU1vYnM6dXBkYXRlKCkKICAKZW5kCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIEhUVEZfVmlrdG9yOkxldmVsKHNwZWxsKQogIHJldHVybiBteUhlcm86R2V0U3BlbGxEYXRhKHNwZWxsKS5sZXZlbAplbmQKCmZ1bmN0aW9uIEhUVEZfVmlrdG9yOlJlYWR5KHNwZWxsKQogIHJldHVybiBzcGVsbCBhbmQgbXlIZXJvOkNhblVzZVNwZWxsKHNwZWxsKSA9PSBSRUFEWQplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gSFRURl9WaWt0b3I6VGFyZ2V0cygpCgogIHNlbGYuUVRTOnVwZGF0ZSgpCiAgc2VsZi5XVFM6dXBkYXRlKCkKICBzZWxmLkVUUzp1cGRhdGUoKQogIHNlbGYuU1RTOnVwZGF0ZSgpCiAgCiAgc2VsZi5RVGFyZ2V0ID0gc2VsZi5RVFMudGFyZ2V0CiAgc2VsZi5XVGFyZ2V0ID0gc2VsZi5XVFMudGFyZ2V0CiAgc2VsZi5FVGFyZ2V0ID0gc2VsZi5FVFMudGFyZ2V0CiAgc2VsZi5TVGFyZ2V0ID0gc2VsZi5TVFMudGFyZ2V0CiAgCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBIVFRGX1Zpa3RvcjpPcmJ3YWxrQ2FuQXR0YWNrKCkKCiAgaWYgc2VsZi5SZWJvcm5Mb2FkZWQgdGhlbgogICAgcmV0dXJuIF9HLkF1dG9DYXJyeS5PcmJ3YWxrZXI6Q2FuU2hvb3QoKQogIGVsc2VpZiBzZWxmLk1NQUxvYWRlZCB0aGVuCiAgICByZXR1cm4gdHJ1ZS0tX0cuTU1BX0F0dGFja0F2YWlsYWJsZQogIGVsc2VpZiBzZWxmLlN4T3JiTG9hZGVkIHRoZW4KICAgIHJldHVybiBzZWxmLlN4T3JiOkNhbkF0dGFjaygpCiAgZWxzZWlmIHNlbGYuU09XTG9hZGVkIHRoZW4KICAgIHJldHVybiBzZWxmLlNPV1ZQOkNhbkF0dGFjaygpCiAgZW5kCiAgCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBIVFRGX1Zpa3RvcjpPcmJ3YWxrQ2FuTW92ZSgpCgogIGlmIHNlbGYuUmVib3JuTG9hZGVkIHRoZW4KICAgIHJldHVybiBfRy5BdXRvQ2FycnkuT3Jid2Fsa2VyOkNhbk1vdmUoKQogIGVsc2VpZiBzZWxmLk1NQUxvYWRlZCB0aGVuCiAgICByZXR1cm4gdHJ1ZS0tX0cuTU1BX0FibGVUb01vdmUKICBlbHNlaWYgc2VsZi5TeE9yYkxvYWRlZCB0aGVuCiAgICByZXR1cm4gc2VsZi5TeE9yYjpDYW5Nb3ZlKCkKICBlbHNlaWYgc2VsZi5TT1dMb2FkZWQgdGhlbgogICAgcmV0dXJuIHNlbGYuU09XVlA6Q2FuTW92ZSgpCiAgZW5kCiAgCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBIVFRGX1Zpa3RvcjpPcmJ3YWxrUmVzZXQoKQoKICBpZiBzZWxmLlJlYm9ybkxvYWRlZCB0aGVuCiAgICBfRy5BdXRvQ2FycnkuT3Jid2Fsa2VyOlJlc2V0QXR0YWNrVGltZXIoKQogIGVsc2VpZiBzZWxmLk1NQUxvYWRlZCB0aGVuCiAgZWxzZWlmIHNlbGYuU3hPcmJMb2FkZWQgdGhlbgogICAgc2VsZi5TeE9yYjpSZXNldEFBKCkKICBlbHNlaWYgc2VsZi5TT1dMb2FkZWQgdGhlbgogICAgc2VsZi5TT1dWUDpyZXNldEFBKCkKICBlbmQKICAKZW5kCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIEhUVEZfVmlrdG9yOkZvbGxvdygpCgogIGlmIHNlbGYuU3Rvcm0gdGhlbgogIAogICAgaWYgc2VsZi5MYXN0UlRhcmdldCBhbmQgbm90IHNlbGYuTGFzdFJUYXJnZXQuZGVhZCBhbmQgR2V0RGlzdGFuY2Uoc2VsZi5MYXN0UlRhcmdldCwgc2VsZi5TdG9ybSkgPD0gc2VsZi5SLnJhZGl1cyB0aGVuCiAgICAgIHNlbGY6Rm9sbG93UihzZWxmLkxhc3RSVGFyZ2V0KQogICAgICByZXR1cm4KICAgIGVsc2VpZiBzZWxmLldUYXJnZXQgYW5kIG5vdCBzZWxmLldUYXJnZXQuZGVhZCBhbmQgR2V0RGlzdGFuY2Uoc2VsZi5XVGFyZ2V0LCBzZWxmLlN0b3JtKSA8PSBzZWxmLlIucmFkaXVzIHRoZW4KICAgICAgc2VsZjpGb2xsb3dSKHNlbGYuV1RhcmdldCkKICAgICAgcmV0dXJuCiAgICBlbHNlCiAgICAKICAgICAgZm9yIGksIGVuZW15IGluIGlwYWlycyhzZWxmLkVuZW15SGVyb2VzKSBkbwogICAgICAKICAgICAgICBpZiBub3QgZW5lbXkuZGVhZCBhbmQgZW5lbXkgfj0gc2VsZi5MYXN0UlRhcmdldCBhbmQgR2V0RGlzdGFuY2UoZW5lbXksIHNlbGYuU3Rvcm0pIDw9IDUwMCB0aGVuCiAgICAgICAgICBzZWxmOkZvbGxvd1IoZW5lbXkpCiAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgICAgICAKICAgICAgZW5kCiAgICAKICAgICAgZm9yIGksIGVuZW15IGluIGlwYWlycyhzZWxmLkVuZW15SGVyb2VzKSBkbwogICAgICAKICAgICAgICBpZiBub3QgZW5lbXkuZGVhZCBhbmQgZW5lbXkgfj0gc2VsZi5MYXN0UlRhcmdldCBhbmQgR2V0RGlzdGFuY2UoZW5lbXksIHNlbGYuU3Rvcm0pIDw9IDIwMDAgdGhlbgogICAgICAgICAgc2VsZjpGb2xsb3dSKGVuZW15KQogICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgIGVuZAogICAgICAKICAgIGVuZAogICAgCiAgICBzZWxmOkZvbGxvd1IobW91c2VQb3MpCiAgZW5kCiAgCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBIVFRGX1Zpa3RvcjpDb21ibygpCgogIGxvY2FsIENvbWJvUSA9IHNlbGYuTWVudS5Db21iby5RCiAgbG9jYWwgQ29tYm9XID0gc2VsZi5NZW51LkNvbWJvLlcKICBsb2NhbCBDb21ib1cyID0gc2VsZi5NZW51LkNvbWJvLlcyCiAgbG9jYWwgQ29tYm9FID0gc2VsZi5NZW51LkNvbWJvLkUKICBsb2NhbCBDb21ib1IgPSBzZWxmLk1lbnUuQ29tYm8uUgogIAogIGlmIHNlbGYuUVRhcmdldCB+PSBuaWwgYW5kIENvbWJvUSBhbmQgc2VsZjpSZWFkeShfUSkgYW5kIDUqc2VsZjpMZXZlbChfUSkrNDAgPD0gbXlIZXJvLm1hbmEgYW5kIFZhbGlkVGFyZ2V0KHNlbGYuUVRhcmdldCwgc2VsZi5RLnJhbmdlKSB0aGVuCiAgICBzZWxmOkNhc3RRKHNlbGYuUVRhcmdldCkKICBlbmQKICAKICBpZiBzZWxmLldUYXJnZXQgfj0gbmlsIGFuZCBDb21ib1cgYW5kIHNlbGY6UmVhZHkoX1cpIGFuZCBDb21ib1cyIDw9IHNlbGY6TWFuYVBlcmNlbnQoKSBhbmQgVmFsaWRUYXJnZXQoc2VsZi5XVGFyZ2V0LCBzZWxmLlcucmFuZ2UpIHRoZW4KICAgIHNlbGY6Q2FzdFcoc2VsZi5XVGFyZ2V0LCAiQ29tYm8iKQogIGVuZAogIAogIGlmIENvbWJvRSBhbmQgc2VsZjpSZWFkeShfRSkgYW5kIDEwKnNlbGY6TGV2ZWwoX0UpKzYwIDw9IG15SGVyby5tYW5hIHRoZW4KICAKICAgIGZvciBpLCBlbmVteSBpbiBpcGFpcnMoc2VsZi5FbmVteUhlcm9lcykgZG8KICAgIAogICAgICBpZiBWYWxpZFRhcmdldChlbmVteSwgc2VsZi5FUmFuZ2UpIHRoZW4KICAgICAgICBzZWxmOkNhc3RFKGVuZW15LCAiQ29tYm8iKQogICAgICBlbmQKICAgICAgCiAgICBlbmQKICAgIAogIGVuZAogIAogIGlmIENvbWJvUiBhbmQgc2VsZjpSZWFkeShfUikgYW5kIDEwMCA8PSBteUhlcm8ubWFuYSB0aGVuCiAgCiAgICBmb3IgaSwgZW5lbXkgaW4gaXBhaXJzKHNlbGYuRW5lbXlIZXJvZXMpIGRvCiAgICAKICAgICAgbG9jYWwgUmVuZW15RG1nID0gc2VsZjpHZXREbWcoIlIiLCBlbmVteSkrMTAqc2VsZjpHZXREbWcoIlIyIiwgZW5lbXkpCiAgICAgIAogICAgICBpZiBSZW5lbXlEbWcgPj0gZW5lbXkuaGVhbHRoIGFuZCBWYWxpZFRhcmdldChlbmVteSwgc2VsZi5SLnJhbmdlKSB0aGVuCiAgICAgICAgc2VsZjpDYXN0UihlbmVteSwgIkNvbWJvIikKICAgICAgZW5kCiAgICAgIAogICAgZW5kCiAgICAKICBlbmQKICAKZW5kCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIEhUVEZfVmlrdG9yOkZhcm0oKQoKICBsb2NhbCBGYXJtUSA9IHNlbGYuTWVudS5DbGVhci5GYXJtLlEKICBsb2NhbCBGYXJtUTIgPSBzZWxmLk1lbnUuQ2xlYXIuRmFybS5RMgogIGxvY2FsIEZhcm1RMyA9IHNlbGYuTWVudS5DbGVhci5GYXJtLlEzCiAgbG9jYWwgRmFybVE0ID0gc2VsZi5NZW51LkNsZWFyLkZhcm0uUTQKICBsb2NhbCBGYXJtRSA9IHNlbGYuTWVudS5DbGVhci5GYXJtLkUKICBsb2NhbCBGYXJtRU1pbiA9IHNlbGYuTWVudS5DbGVhci5GYXJtLkVNaW4KICAKICBpZiBGYXJtUSBhbmQgc2VsZjpSZWFkeShfUSkgYW5kIEZhcm1RMiA8PSBzZWxmOk1hbmFQZXJjZW50KCkgdGhlbgogIAogICAgZm9yIGksIG1pbmlvbiBpbiBwYWlycyhzZWxmLmVjRW5lbXlNaW5pb25zLm9iamVjdHMpIGRvCiAgICAKICAgICAgbG9jYWwgUU1pbmlvbkRtZyA9IHNlbGY6R2V0RG1nKCJRIiwgbWluaW9uKQogICAgICAKICAgICAgaWYgUU1pbmlvbkRtZyA+PSBtaW5pb24uaGVhbHRoIGFuZCBWYWxpZFRhcmdldChtaW5pb24sIHNlbGYuUS5yYW5nZSkgYW5kIChHZXREaXN0YW5jZShtaW5pb24sIG15SGVybykgPD0gc2VsZjpUcnVlUmFuZ2UobWluaW9uKSBhbmQgbm90KEZhcm1RMyBhbmQgc2VsZjpPcmJ3YWxrQ2FuQXR0YWNrKCkpIG9yIEdldERpc3RhbmNlKG1pbmlvbiwgbXlIZXJvKSA+IHNlbGY6VHJ1ZVJhbmdlKG1pbmlvbikpIHRoZW4KICAgICAgICBzZWxmOkNhc3RRKG1pbmlvbikKICAgICAgICByZXR1cm4KICAgICAgZW5kCiAgICAgIAogICAgZW5kCiAgICAKICAgIGlmIG5vdCBGYXJtUTQgdGhlbgogICAgCiAgICAgIGZvciBpLCBtaW5pb24gaW4gcGFpcnMoc2VsZi5lY0VuZW15TWluaW9ucy5vYmplY3RzKSBkbwogICAgICAKICAgICAgICBsb2NhbCBBQU1pbmlvbkRtZyA9IHNlbGY6R2V0RG1nKCJBQSIsIHNtaW5pb24pCiAgICAgICAgbG9jYWwgUU1pbmlvbkRtZyA9IHNlbGY6R2V0RG1nKCJRIiwgbWluaW9uKQogICAgICAgIAogICAgICAgIGlmIFFNaW5pb25EbWcrMi41KkFBTWluaW9uRG1nIDw9IG1pbmlvbi5oZWFsdGggYW5kIFZhbGlkVGFyZ2V0KG1pbmlvbiwgc2VsZi5RLnJhbmdlKSBhbmQgKEdldERpc3RhbmNlKG1pbmlvbiwgbXlIZXJvKSA8PSBzZWxmOlRydWVSYW5nZShtaW5pb24pIGFuZCBub3Qgc2VsZjpPcmJ3YWxrQ2FuQXR0YWNrKCkgb3IgR2V0RGlzdGFuY2UobWluaW9uLCBteUhlcm8pID4gc2VsZjpUcnVlUmFuZ2UobWluaW9uKSkgdGhlbgogICAgICAgICAgc2VsZjpDYXN0UShtaW5pb24pCiAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgIGVuZAogICAgICAKICAgIGVuZAogICAgCiAgZW5kCiAgCiAgaWYgRmFybUUgYW5kIHNlbGY6UmVhZHkoX0UpIGFuZCAxMCpzZWxmOkxldmVsKF9FKSs2MCA8PSBteUhlcm8ubWFuYSBhbmQgb3MuY2xvY2soKS1zZWxmLkxhc3RGYXJtRSA+PSAuMjUgdGhlbgogICAgc2VsZi5MYXN0RmFybUUgPSBvcy5jbG9jaygpCiAgICAKICAgIGZvciBpLCBzbWluaW9uIGluIHBhaXJzKHNlbGYuc0VuZW15TWluaW9ucy5vYmplY3RzKSBkbwogICAgCiAgICAgIGxvY2FsIEVNaW5pb25EbWcgPSBzZWxmOkdldERtZygiRSIsIHNtaW5pb24pCiAgICAgIAogICAgICBpZiBub3Qgc21pbmlvbi5kZWFkIGFuZCBFTWluaW9uRG1nID49IHNtaW5pb24uaGVhbHRoIHRoZW4KICAgICAgCiAgICAgICAgZm9yIGosIGVtaW5pb24gaW4gcGFpcnMoc2VsZi5lY0VuZW15TWluaW9ucy5vYmplY3RzKSBkbwogICAgICAgIAogICAgICAgICAgbG9jYWwgZW5kUG9zLCBIaXRDaGFuY2UgPSBzZWxmLkhQcmVkOkdldFByZWRpY3Qoc2VsZi5IUHJlZC5QcmVzZXRzWydWaWt0b3InXVsiRSJdLCBlbWluaW9uLCBzbWluaW9uKQogICAgICAgICAgCiAgICAgICAgICBpZiBlbmRQb3Mgfj0gbmlsIGFuZCBzbWluaW9uIH49IGVtaW5pb24gdGhlbgogICAgICAgICAgCiAgICAgICAgICAgIGxvY2FsIEVOb0ggPSAwCiAgICAgICAgICAgIAogICAgICAgICAgICBmb3IgaywgbWluaW9uIGluIHBhaXJzKHNlbGYuZWNFbmVteU1pbmlvbnMub2JqZWN0cykgZG8KICAgICAgICAgICAgCiAgICAgICAgICAgICAgaWYgbm90IHNtaW5pb24uZGVhZCBhbmQgR2V0RGlzdGFuY2UobWluaW9uLCBzbWluaW9uKSA8PSBzZWxmLkUucmFuZ2UyKzMwMCBhbmQgc2VsZi5IUHJlZDpTcGVsbENvbGxpc2lvbihzZWxmLkhQcmVkLlByZXNldHNbJ1Zpa3RvciddWyJFIl0sIG1pbmlvbiwgc21pbmlvbiwgZW5kUG9zKSB0aGVuCiAgICAgICAgICAgICAgICBFTm9IID0gRU5vSCsxCiAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICAKICAgICAgICAgICAgaWYgRU5vSCA+PSBGYXJtRU1pbiBhbmQgRU5vSCpteUhlcm8ubWFuYS8oMTAqc2VsZjpMZXZlbChfRSkrNjApID49IDEwIHRoZW4KICAgICAgICAgICAgICBDYXN0U3BlbGwzKF9FLCBEM0RYVkVDVE9SMyhzbWluaW9uLngsIDAsIHNtaW5pb24ueiksIEQzRFhWRUNUT1IzKGVuZFBvcy54LCAwLCBlbmRQb3MueikpCiAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICAKICAgICAgICAgIGVuZAogICAgICAgICAgCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgIGVuZAogICAgICAKICAgIGVuZAogICAgCiAgICBmb3IgaSwgc21pbmlvbiBpbiBwYWlycyhzZWxmLnNFbmVteU1pbmlvbnMub2JqZWN0cykgZG8KICAgIAogICAgICBsb2NhbCBFTWluaW9uRG1nID0gc2VsZjpHZXREbWcoIkUiLCBzbWluaW9uKQogICAgICBsb2NhbCBBQU1pbmlvbkRtZyA9IHNlbGY6R2V0RG1nKCJBQSIsIHNtaW5pb24pCiAgICAgIAogICAgICBpZiBFTWluaW9uRG1nKzIuNSpBQU1pbmlvbkRtZyA8PSBzbWluaW9uLmhlYWx0aCB0aGVuCiAgICAgIAogICAgICAgIGZvciBqLCBlbWluaW9uIGluIHBhaXJzKHNlbGYuZWNFbmVteU1pbmlvbnMub2JqZWN0cykgZG8KICAgICAgICAKICAgICAgICAgIGxvY2FsIGVuZFBvcywgSGl0Q2hhbmNlID0gc2VsZi5IUHJlZDpHZXRQcmVkaWN0KHNlbGYuSFByZWQuUHJlc2V0c1snVmlrdG9yJ11bIkUiXSwgZW1pbmlvbiwgc21pbmlvbikKICAgICAgICAgIAogICAgICAgICAgaWYgZW5kUG9zIH49IG5pbCBhbmQgc21pbmlvbiB+PSBlbWluaW9uIHRoZW4KICAgICAgICAgIAogICAgICAgICAgICBsb2NhbCBFTm9IID0gMAogICAgICAgICAgICAKICAgICAgICAgICAgZm9yIGssIG1pbmlvbiBpbiBwYWlycyhzZWxmLmVjRW5lbXlNaW5pb25zLm9iamVjdHMpIGRvCiAgICAgICAgICAgIAogICAgICAgICAgICAgIGlmIG5vdCBzbWluaW9uLmRlYWQgYW5kIEdldERpc3RhbmNlKG1pbmlvbiwgc21pbmlvbikgPD0gc2VsZi5FLnJhbmdlMiszMDAgYW5kIHNlbGYuSFByZWQ6U3BlbGxDb2xsaXNpb24oc2VsZi5IUHJlZC5QcmVzZXRzWydWaWt0b3InXVsiRSJdLCBtaW5pb24sIHNtaW5pb24sIGVuZFBvcykgdGhlbgogICAgICAgICAgICAgICAgRU5vSCA9IEVOb0grMQogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgIAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIEVOb0ggPj0gRmFybUVNaW4gYW5kIEVOb0gqbXlIZXJvLm1hbmEvKDEwKnNlbGY6TGV2ZWwoX0UpKzYwKSA+PSAyMCB0aGVuCiAgICAgICAgICAgICAgQ2FzdFNwZWxsMyhfRSwgRDNEWFZFQ1RPUjMoc21pbmlvbi54LCAwLCBzbWluaW9uLnopLCBEM0RYVkVDVE9SMyhlbmRQb3MueCwgMCwgZW5kUG9zLnopKQogICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBlbmQKICAgICAgICAgICAgCiAgICAgICAgICBlbmQKICAgICAgICAgIAogICAgICAgIGVuZAogICAgICAgIAogICAgICBlbmQKICAgICAgCiAgICBlbmQKICAgIAogIGVuZAogIAplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gSFRURl9WaWt0b3I6SkZhcm0oKQoKICBsb2NhbCBKRmFybVEgPSBzZWxmLk1lbnUuQ2xlYXIuSkZhcm0uUQogIGxvY2FsIEpGYXJtRSA9IHNlbGYuTWVudS5DbGVhci5KRmFybS5FCiAgCiAgaWYgc2VsZjpSZWFkeShfUSkgYW5kIEpGYXJtUSBhbmQgNSpzZWxmOkxldmVsKF9RKSs0MCA8PSBteUhlcm8ubWFuYSB0aGVuCiAgCiAgICBmb3IgaSwganVuZ2xlbW9iIGluIHBhaXJzKHNlbGYuSnVuZ2xlTW9icy5vYmplY3RzKSBkbwogICAgCiAgICAgIGxvY2FsIExhcmdlSnVuZ2xlbW9iID0gbmlsCiAgICAgIAogICAgICBmb3IgaiA9IDEsICNzZWxmLkZvY3VzSnVuZ2xlTmFtZXMgZG8KICAgICAgCiAgICAgICAgaWYganVuZ2xlbW9iLm5hbWUgPT0gc2VsZi5Gb2N1c0p1bmdsZU5hbWVzW2pdIHRoZW4KICAgICAgICAgIExhcmdlSnVuZ2xlbW9iID0ganVuZ2xlbW9iCiAgICAgICAgICBicmVhawogICAgICAgIGVuZAogICAgICAgIAogICAgICBlbmQKICAgICAgCiAgICAgIGlmIExhcmdlSnVuZ2xlbW9iIH49IG5pbCB0aGVuCiAgICAKICAgICAgICBpZiBHZXREaXN0YW5jZShMYXJnZUp1bmdsZW1vYiwgbW91c2VQb3MpIDw9IDEwMDAgYW5kIFZhbGlkVGFyZ2V0KExhcmdlSnVuZ2xlbW9iLCBzZWxmLlEucmFuZ2UpIHRoZW4KICAgICAgICAgIHNlbGY6Q2FzdFEoTGFyZ2VKdW5nbGVtb2IpCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgcmV0dXJuCiAgICAgIGVuZAogICAgICAKICAgIGVuZAogICAgCiAgICBmb3IgaSwganVuZ2xlbW9iIGluIHBhaXJzKHNlbGYuSnVuZ2xlTW9icy5vYmplY3RzKSBkbwogICAgCiAgICAgIGlmIFZhbGlkVGFyZ2V0KGp1bmdsZW1vYiwgc2VsZi5RLnJhbmdlKSB0aGVuCiAgICAgICAgc2VsZjpDYXN0UShqdW5nbGVtb2IpCiAgICAgICAgcmV0dXJuCiAgICAgIGVuZAogICAgICAKICAgIGVuZAogICAgCiAgZW5kCiAgCiAgaWYgc2VsZjpSZWFkeShfRSkgYW5kIEpGYXJtRSBhbmQgMTAqc2VsZjpMZXZlbChfRSkrNjAgPD0gbXlIZXJvLm1hbmEgdGhlbgogIAogICAgZm9yIGksIGp1bmdsZW1vYiBpbiBwYWlycyhzZWxmLkp1bmdsZU1vYnMub2JqZWN0cykgZG8KICAgIAogICAgICBsb2NhbCBMYXJnZUp1bmdsZW1vYiA9IG5pbAogICAgICAgICAgCiAgICAgIGZvciBqID0gMSwgI3NlbGYuRm9jdXNKdW5nbGVOYW1lcyBkbwogICAgICAKICAgICAgICBpZiBqdW5nbGVtb2IubmFtZSA9PSBzZWxmLkZvY3VzSnVuZ2xlTmFtZXNbal0gdGhlbgogICAgICAgICAgTGFyZ2VKdW5nbGVtb2IgPSBqdW5nbGVtb2IKICAgICAgICAgIGJyZWFrCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgIGVuZAogICAgICAKICAgICAgaWYgTGFyZ2VKdW5nbGVtb2Igfj0gbmlsIHRoZW4KICAgICAgCiAgICAgICAgaWYgR2V0RGlzdGFuY2UoTGFyZ2VKdW5nbGVtb2IsIG1vdXNlUG9zKSA8PSAxMDAwIGFuZCBWYWxpZFRhcmdldChMYXJnZUp1bmdsZW1vYiwgc2VsZi5FUmFuZ2UpIHRoZW4KICAgICAgICAKICAgICAgICAgIGZvciBqLCBlanVuZ2xlbW9iIGluIHBhaXJzKHNlbGYuSnVuZ2xlTW9icy5vYmplY3RzKSBkbwogICAgICAgICAgCiAgICAgICAgICAgIGxvY2FsIGVuZFBvcywgSGl0Q2hhbmNlID0gc2VsZi5IUHJlZDpHZXRQcmVkaWN0KHNlbGYuSFByZWQuUHJlc2V0c1snVmlrdG9yJ11bIkUiXSwgZWp1bmdsZW1vYiwgTGFyZ2VKdW5nbGVtb2IpCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiBlbmRQb3Mgfj0gbmlsIGFuZCBMYXJnZUp1bmdsZW1vYiB+PSBlanVuZ2xlbW9iIHRoZW4KICAgICAgICAgICAgCiAgICAgICAgICAgICAgbG9jYWwgRU5vSCA9IDAKICAgICAgICAgICAgICAKICAgICAgICAgICAgICBmb3IgaywgY2p1bmdsZW1vYiBpbiBwYWlycyhzZWxmLkp1bmdsZU1vYnMub2JqZWN0cykgZG8KICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIEdldERpc3RhbmNlKGNqdW5nbGVtb2IsIExhcmdlSnVuZ2xlbW9iKSA8PSBzZWxmLkUucmFuZ2UyKzMwMCBhbmQgc2VsZi5IUHJlZDpTcGVsbENvbGxpc2lvbihzZWxmLkhQcmVkLlByZXNldHNbJ1Zpa3RvciddWyJFIl0sIGNqdW5nbGVtb2IsIExhcmdlSnVuZ2xlbW9iLCBlbmRQb3MpIHRoZW4KICAgICAgICAgICAgICAgICAgRU5vSCA9IEVOb0grMQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAKICAgICAgICAgICAgICBpZiBFTm9IID49IDIgdGhlbgogICAgICAgICAgICAgICAgQ2FzdFNwZWxsMyhfRSwgRDNEWFZFQ1RPUjMoTGFyZ2VKdW5nbGVtb2IueCwgMCwgTGFyZ2VKdW5nbGVtb2IueiksIEQzRFhWRUNUT1IzKGVuZFBvcy54LCAwLCBlbmRQb3MueikpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIAogICAgICAgICAgZW5kCiAgICAgICAgICAKICAgICAgICAgIHNlbGY6Q2FzdEUoTGFyZ2VKdW5nbGVtb2IsICJKRmFybSIpCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgcmV0dXJuCiAgICAgIGVuZAogICAgICAKICAgIGVuZAogICAgCiAgICBpZiBvcy5jbG9jaygpLXNlbGYuTGFzdEpGYXJtRSA+PSAuMjUgdGhlbgogICAgICBzZWxmLkxhc3RKRmFybUUgPSBvcy5jbG9jaygpCiAgICAgIAogICAgICBmb3IgaSwgc2p1bmdsZW1vYiBpbiBwYWlycyhzZWxmLkp1bmdsZU1vYnMub2JqZWN0cykgZG8KICAgICAgCiAgICAgICAgaWYgVmFsaWRUYXJnZXQoc2p1bmdsZW1vYiwgc2VsZi5FLnJhbmdlMSkgdGhlbgogICAgICAgIAogICAgICAgICAgZm9yIGosIGVqdW5nbGVtb2IgaW4gcGFpcnMoc2VsZi5KdW5nbGVNb2JzLm9iamVjdHMpIGRvCiAgICAgICAgICAKICAgICAgICAgICAgbG9jYWwgZW5kUG9zLCBIaXRDaGFuY2UgPSBzZWxmLkhQcmVkOkdldFByZWRpY3Qoc2VsZi5IUHJlZC5QcmVzZXRzWydWaWt0b3InXVsiRSJdLCBlanVuZ2xlbW9iLCBzanVuZ2xlbW9iKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgZW5kUG9zIH49IG5pbCBhbmQgc2p1bmdsZW1vYiB+PSBlanVuZ2xlbW9iIHRoZW4KICAgICAgICAgICAgCiAgICAgICAgICAgICAgbG9jYWwgRU5vSCA9IDAKICAgICAgICAgICAgICAKICAgICAgICAgICAgICBmb3IgaywgY2p1bmdsZW1vYiBpbiBwYWlycyhzZWxmLkp1bmdsZU1vYnMub2JqZWN0cykgZG8KICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIEdldERpc3RhbmNlKGNqdW5nbGVtb2IsIHNqdW5nbGVtb2IpIDw9IHNlbGYuRS5yYW5nZTIrMzAwIGFuZCBzZWxmLkhQcmVkOlNwZWxsQ29sbGlzaW9uKHNlbGYuSFByZWQuUHJlc2V0c1snVmlrdG9yJ11bIkUiXSwgY2p1bmdsZW1vYiwgc2p1bmdsZW1vYiwgZW5kUG9zKSB0aGVuCiAgICAgICAgICAgICAgICAgIEVOb0ggPSBFTm9IKzEKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgaWYgRU5vSCA+PSAyIHRoZW4KICAgICAgICAgICAgICAgIENhc3RTcGVsbDMoX0UsIEQzRFhWRUNUT1IzKHNqdW5nbGVtb2IueCwgMCwgc2p1bmdsZW1vYi56KSwgRDNEWFZFQ1RPUjMoZW5kUG9zLngsIDAsIGVuZFBvcy56KSkKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgIAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgCiAgICAgICAgICBlbmQKICAgICAgICAgIAogICAgICAgIGVuZAogICAgICAgIAogICAgICBlbmQKICAgICAgCiAgICBlbmQKICAgIAogIGVuZAogIAplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gSFRURl9WaWt0b3I6SGFyYXNzKCkKCiAgbG9jYWwgSGFyYXNzUSA9IHNlbGYuTWVudS5IYXJhc3MuUQogIGxvY2FsIEhhcmFzc0UgPSBzZWxmLk1lbnUuSGFyYXNzLkUKICAKICBpZiBzZWxmLlFUYXJnZXQgfj0gbmlsIGFuZCBIYXJhc3NRIGFuZCBzZWxmOlJlYWR5KF9RKSBhbmQgNSpzZWxmOkxldmVsKF9RKSs0MCA8PSBteUhlcm8ubWFuYSBhbmQgVmFsaWRUYXJnZXQoc2VsZi5RVGFyZ2V0LCBzZWxmLlFyYW5nZSkgdGhlbgogICAgc2VsZjpDYXN0UShzZWxmLlFUYXJnZXQpCiAgZW5kCiAgCiAgaWYgc2VsZi5FVGFyZ2V0IH49IG5pbCBhbmQgSGFyYXNzRSBhbmQgc2VsZjpSZWFkeShfRSkgYW5kIDEwKnNlbGY6TGV2ZWwoX0UpKzYwIDw9IG15SGVyby5tYW5hIGFuZCBWYWxpZFRhcmdldChzZWxmLkVUYXJnZXQsIHNlbGYuRXJhbmdlKSB0aGVuCiAgICBzZWxmOkNhc3RFKHNlbGYuRVRhcmdldCwgIkhhcmFzcyIpCiAgZW5kCiAgCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBIVFRGX1Zpa3RvcjpMYXN0SGl0KCkKCiAgbG9jYWwgTGFzdEhpdFEgPSBzZWxmLk1lbnUuTGFzdEhpdC5RCiAgbG9jYWwgTGFzdEhpdFEyID0gc2VsZi5NZW51Lkxhc3RIaXQuUTIKICAKICBpZiBMYXN0SGl0USBhbmQgc2VsZjpSZWFkeShfUSkgYW5kIExhc3RIaXRRMiA8PSBzZWxmOk1hbmFQZXJjZW50KCkgdGhlbgogIAogICAgZm9yIGksIG1pbmlvbiBpbiBwYWlycyhzZWxmLmVjRW5lbXlNaW5pb25zLm9iamVjdHMpIGRvCiAgICAKICAgICAgbG9jYWwgUU1pbmlvbkRtZyA9IHNlbGY6R2V0RG1nKCJRIiwgbWluaW9uKQogICAgICAKICAgICAgaWYgUU1pbmlvbkRtZyA+PSBtaW5pb24uaGVhbHRoIGFuZCBWYWxpZFRhcmdldChtaW5pb24sIHNlbGYuUS5yYW5nZSkgdGhlbgogICAgICAgIHNlbGY6Q2FzdFEobWluaW9uKQogICAgICAgIHJldHVybgogICAgICBlbmQKICAgICAgCiAgICBlbmQKICAgIAogIGVuZAogIAplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gSFRURl9WaWt0b3I6SlN0ZWFsKCkKCiAgbG9jYWwgSlN0ZWFsUyA9IHNlbGYuTWVudS5KU3RlYWwuUwogIAogIGlmIHNlbGY6UmVhZHkoc2VsZi5TbWl0ZSkgYW5kIEpTdGVhbFMgdGhlbgogIAogICAgZm9yIGksIGp1bmdsZW1vYiBpbiBwYWlycyhzZWxmLkp1bmdsZU1vYnMub2JqZWN0cykgZG8KICAgICAgICAgIAogICAgICBsb2NhbCBTSnVuZ2xlbW9iRG1nID0gc2VsZjpHZXREbWcoIlNNSVRFIiwganVuZ2xlbW9iKQogICAgICAKICAgICAgZm9yIGogPSAxLCAjc2VsZi5Gb2N1c0p1bmdsZU5hbWVzIGRvCiAgICAgIAogICAgICAgIGlmIGp1bmdsZW1vYi5uYW1lID09IHNlbGYuRm9jdXNKdW5nbGVOYW1lc1tqXSBhbmQgU0p1bmdsZW1vYkRtZyA+PSBqdW5nbGVtb2IuaGVhbHRoIGFuZCBWYWxpZFRhcmdldChqdW5nbGVtb2IsIHNlbGYuUy5yYW5nZSkgdGhlbgogICAgICAgICAgc2VsZjpDYXN0UyhqdW5nbGVtb2IpCiAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgICAgICAKICAgICAgZW5kCiAgICAgIAogICAgZW5kCiAgICAKICBlbmQKICAKZW5kCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIEhUVEZfVmlrdG9yOkpzdGVhbEFsd2F5cygpCgogIGlmIHNlbGY6UmVhZHkoc2VsZi5TbWl0ZSkgdGhlbgogIAogICAgZm9yIGksIGp1bmdsZW1vYiBpbiBwYWlycyhzZWxmLkp1bmdsZU1vYnMub2JqZWN0cykgZG8KICAgIAogICAgICBsb2NhbCBTSnVuZ2xlbW9iRG1nID0gc2VsZjpHZXREbWcoIlNNSVRFIiwganVuZ2xlbW9iKQogICAgICAKICAgICAgZm9yIGogPSAxLCAjc2VsZi5Gb2N1c0p1bmdsZU5hbWVzIGRvCiAgICAgIAogICAgICAgIGlmIChqdW5nbGVtb2IubmFtZSA9PSAiU1JVX0Jhcm9uMTIuMS4xIiBvciBqdW5nbGVtb2IubmFtZSA9PSAiU1JVX0RyYWdvbjYuMS4xIikgYW5kIFNKdW5nbGVtb2JEbWcgPj0ganVuZ2xlbW9iLmhlYWx0aCBhbmQgVmFsaWRUYXJnZXQoanVuZ2xlbW9iLCBzZWxmLlMucmFuZ2UpIHRoZW4KICAgICAgICAgIHNlbGY6Q2FzdFMoanVuZ2xlbW9iKQogICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgIGVuZAogICAgICAKICAgIGVuZAogICAgCiAgZW5kCiAgCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBIVFRGX1Zpa3RvcjpLaWxsU3RlYWwoKQoKICBsb2NhbCBLaWxsU3RlYWxRID0gc2VsZi5NZW51LktpbGxTdGVhbC5RCiAgbG9jYWwgS2lsbFN0ZWFsRSA9IHNlbGYuTWVudS5LaWxsU3RlYWwuRQogIGxvY2FsIEtpbGxTdGVhbFIgPSBzZWxmLk1lbnUuS2lsbFN0ZWFsLlIKICBsb2NhbCBLaWxsU3RlYWxJID0gc2VsZi5NZW51LktpbGxTdGVhbC5JCiAgbG9jYWwgS2lsbFN0ZWFsUyA9IHNlbGYuTWVudS5LaWxsU3RlYWwuUwogIAogIGZvciBpLCBlbmVteSBpbiBpcGFpcnMoc2VsZi5FbmVteUhlcm9lcykgZG8KICAKICAgIGxvY2FsIFFlbmVteURtZyA9IHNlbGY6R2V0RG1nKCJRIiwgZW5lbXkpCiAgICBsb2NhbCBFZW5lbXlEbWcgPSBzZWxmOkdldERtZygiRSIsIGVuZW15KQogICAgbG9jYWwgUmVuZW15RG1nID0gc2VsZjpHZXREbWcoIlIiLCBlbmVteSkKICAgIGxvY2FsIEllbmVteURtZyA9IHNlbGY6R2V0RG1nKCJJR05JVEUiLCBlbmVteSkKICAgIAogICAgaWYgS2lsbFN0ZWFsSSBhbmQgc2VsZjpSZWFkeShzZWxmLklnbml0ZSkgYW5kIEllbmVteURtZyA+PSBlbmVteS5oZWFsdGggYW5kIFZhbGlkVGFyZ2V0KGVuZW15LCBzZWxmLkkucmFuZ2UpIHRoZW4KICAgICAgc2VsZjpDYXN0SShlbmVteSkKICAgIGVuZAogICAgCiAgICBpZiBLaWxsU3RlYWxSIGFuZCBzZWxmOlJlYWR5KF9SKSBhbmQgUmVuZW15RG1nID49IGVuZW15LmhlYWx0aCBhbmQgMTAwIDw9IG15SGVyby5tYW5hIGFuZCBWYWxpZFRhcmdldChlbmVteSwgc2VsZi5SLnJhbmdlKSB0aGVuCiAgICAgIHNlbGY6Q2FzdFIoZW5lbXkpCiAgICAgIHJldHVybgogICAgZW5kCiAgICAKICAgIGlmIEtpbGxTdGVhbFEgYW5kIHNlbGY6UmVhZHkoX1EpIGFuZCBRZW5lbXlEbWcgPj0gZW5lbXkuaGVhbHRoIGFuZCA1KnNlbGY6TGV2ZWwoX1EpKzQwIGFuZCBWYWxpZFRhcmdldChlbmVteSwgc2VsZi5RLnJhbmdlKSB0aGVuCiAgICAgIHNlbGY6Q2FzdFEoZW5lbXksICJLaWxsU3RlYWwiKQogICAgICByZXR1cm4KICAgIGVuZAogICAgCiAgICBpZiBLaWxsU3RlYWxFIGFuZCBzZWxmOlJlYWR5KF9FKSBhbmQgKEVlbmVteURtZyA+PSBlbmVteS5oZWFsdGggYW5kIDEwKnNlbGY6TGV2ZWwoX0UpKzYwIDw9IG15SGVyby5tYW5hIG9yIEtpbGxTdGVhbFEgYW5kIHNlbGY6UmVhZHkoX1EpIGFuZCBHZXREaXN0YW5jZShlbmVteSwgbXlIZXJvKSA8PSBzZWxmLlEucmFuZ2UgYW5kIFFlbmVteURtZytFZW5lbXlEbWcgPj0gZW5lbXkuaGVhbHRoIGFuZCA1KnNlbGY6TGV2ZWwoX1EpKzEwKnNlbGY6TGV2ZWwoX0UpKzEwMCA8PSBteUhlcm8ubWFuYSkgYW5kIFZhbGlkVGFyZ2V0KGVuZW15LCBzZWxmLkVSYW5nZSkgdGhlbgogICAgICBzZWxmOkNhc3RFKGVuZW15KQogICAgICByZXR1cm4KICAgIGVuZAogICAgCiAgZW5kCiAgCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBIVFRGX1Zpa3RvcjpGbGVlKCkKCiAgc2VsZjpNb3ZlVG9Nb3VzZSgpCiAgCiAgaWYgc2VsZi5XVGFyZ2V0IH49IG5pbCBhbmQgc2VsZjpSZWFkeShfVykgYW5kIFZhbGlkVGFyZ2V0KHNlbGYuV1RhcmdldCwgc2VsZi5XLnJhbmdlKSB0aGVuCiAgICBzZWxmOkNhc3RXKHNlbGYuV1RhcmdldCkgIAogIGVuZAogIAplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIEhUVEZfVmlrdG9yOkFkZFJhbmdlKHVuaXQpCiAgcmV0dXJuIHVuaXQuYm91bmRpbmdSYWRpdXMKZW5kCgpmdW5jdGlvbiBIVFRGX1Zpa3RvcjpUcnVlUmFuZ2UoZW5lbXkpCiAgcmV0dXJuIG15SGVyby5yYW5nZStzZWxmOkFkZFJhbmdlKG15SGVybykrc2VsZjpBZGRSYW5nZShlbmVteSkKZW5kCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIEhUVEZfVmlrdG9yOkhlYWx0aFBlcmNlbnQodW5pdCkKICByZXR1cm4gKHVuaXQuaGVhbHRoL3VuaXQubWF4SGVhbHRoKSoxMDAKZW5kCgpmdW5jdGlvbiBIVFRGX1Zpa3RvcjpNYW5hUGVyY2VudCgpCiAgcmV0dXJuIChteUhlcm8ubWFuYS9teUhlcm8ubWF4TWFuYSkqMTAwCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gSFRURl9WaWt0b3I6R2V0RG1nKHNwZWxsLCBlbmVteSkKCiAgaWYgZW5lbXkuaGVhbHRoID09IDAgdGhlbgogICAgcmV0dXJuIDAKICBlbmQKICAKICBsb2NhbCBBRERtZyA9IDAKICBsb2NhbCBBUERtZyA9IDAKICAKICBsb2NhbCBMZXZlbCA9IG15SGVyby5sZXZlbAogIGxvY2FsIFRvdGFsRG1nID0gbXlIZXJvLnRvdGFsRGFtYWdlCiAgbG9jYWwgQWRkRG1nID0gbXlIZXJvLmFkZERhbWFnZQogIGxvY2FsIEFQID0gbXlIZXJvLmFwCiAgbG9jYWwgQXJtb3JQZW4gPSBteUhlcm8uYXJtb3JQZW4KICBsb2NhbCBBcm1vclBlblBlcmNlbnQgPSBteUhlcm8uYXJtb3JQZW5QZXJjZW50CiAgbG9jYWwgTWFnaWNQZW4gPSBteUhlcm8ubWFnaWNQZW4KICBsb2NhbCBNYWdpY1BlblBlcmNlbnQgPSBteUhlcm8ubWFnaWNQZW5QZXJjZW50CiAgCiAgbG9jYWwgQXJtb3IgPSBtYXRoLm1heCgwLCBlbmVteS5hcm1vcipBcm1vclBlblBlcmNlbnQtQXJtb3JQZW4pCiAgbG9jYWwgQXJtb3JQZXJjZW50ID0gQXJtb3IvKDEwMCtBcm1vcikKICBsb2NhbCBNYWdpY0FybW9yID0gbWF0aC5tYXgoMCwgZW5lbXkubWFnaWNBcm1vcipNYWdpY1BlblBlcmNlbnQtTWFnaWNQZW4pCiAgbG9jYWwgTWFnaWNBcm1vclBlcmNlbnQgPSBNYWdpY0FybW9yLygxMDArTWFnaWNBcm1vcikKICAKICBpZiBzcGVsbCA9PSAiSUdOSVRFIiB0aGVuCiAgCiAgICBsb2NhbCBUcnVlRG1nID0gNTArMjAqTGV2ZWwKICAgIAogICAgcmV0dXJuIFRydWVEbWcKICBlbHNlaWYgc3BlbGwgPT0gIlNNSVRFIiB0aGVuCiAgCiAgICBpZiBMZXZlbCA8PSA0IHRoZW4KICAgIAogICAgICBsb2NhbCBUcnVlRG1nID0gMzcwKzIwKkxldmVsCiAgICAgIAogICAgICByZXR1cm4gVHJ1ZURtZwogICAgZWxzZWlmIExldmVsIDw9IDkgdGhlbgogICAgCiAgICAgIGxvY2FsIFRydWVEbWcgPSAzMzArMzAqTGV2ZWwKICAgICAgCiAgICAgIHJldHVybiBUcnVlRG1nCiAgICBlbHNlaWYgTGV2ZWwgPD0gMTQgdGhlbgogICAgCiAgICAgIGxvY2FsIFRydWVEbWcgPSAyNDArNDAqTGV2ZWwKICAgICAgCiAgICAgIHJldHVybiBUcnVlRG1nCiAgICBlbHNlCiAgICAKICAgICAgbG9jYWwgVHJ1ZURtZyA9IDEwMCs1MCpMZXZlbAogICAgICAKICAgICAgcmV0dXJuIFRydWVEbWcKICAgIGVuZAogICAgCiAgZWxzZWlmIHNwZWxsID09ICJTVEFMS0VSIiB0aGVuCiAgCiAgICBsb2NhbCBUcnVlRG1nID0gMjArOCpMZXZlbAogICAgCiAgICByZXR1cm4gVHJ1ZURtZwogIGVsc2VpZiBzcGVsbCA9PSAiQkMiIHRoZW4KICAgIEFQRG1nID0gMTAwCiAgZWxzZWlmIHNwZWxsID09ICJCUksiIHRoZW4KICAgIEFERG1nID0gbWF0aC5tYXgoMTAwLCAuMSplbmVteS5tYXhIZWFsdGgpCiAgZWxzZWlmIHNwZWxsID09ICJBQSIgdGhlbgogICAgQUREbWcgPSBUb3RhbERtZwogIGVsc2VpZiBzcGVsbCA9PSAiUSIgdGhlbgogICAgQVBEbWcgPSAyMCpzZWxmOkxldmVsKF9RKSsyMCsuMipBUAogIGVsc2VpZiBzcGVsbCA9PSAiRSIgdGhlbgogICAgQVBEbWcgPSA0NSpzZWxmOkxldmVsKF9FKSsyNSsuNypBUAogIGVsc2VpZiBzcGVsbCA9PSAiUiIgdGhlbgogICAgQVBEbWcgPSAxMDAqc2VsZjpMZXZlbChfUikrNTArLjU1KkFQCiAgZWxzZWlmIHNwZWxsID09ICJSMiIgdGhlbgogICAgQVBEbWcgPSAxNSpzZWxmOkxldmVsKF9SKSsuMSpBUAogIGVuZAogIAogIGxvY2FsIFRydWVEbWcgPSBBRERtZyooMS1Bcm1vclBlcmNlbnQpK0FQRG1nKigxLU1hZ2ljQXJtb3JQZXJjZW50KQogIAogIHJldHVybiBUcnVlRG1nCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gSFRURl9WaWt0b3I6Q2FzdFEodW5pdCwgbW9kZSkKCiAgaWYgdW5pdC5kZWFkIG9yIHVuaXQuaGVhbHRoID09IDAgb3IgbW9kZSB+PSAiS2lsbFN0ZWFsIiBhbmQgbm90IHNlbGY6T3Jid2Fsa0Nhbk1vdmUoKSB0aGVuCiAgICByZXR1cm4KICBlbmQKICAKICBDYXN0U3BlbGwoX1EsIHVuaXQpCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBIVFRGX1Zpa3RvcjpDYXN0Vyh1bml0LCBtb2RlKQoKICBpZiB1bml0LmRlYWQgb3IgdW5pdC5oZWFsdGggPT0gMCB0aGVuCiAgICByZXR1cm4KICBlbmQKICAKICBzZWxmLldQb3MsIHNlbGYuV0hpdENoYW5jZSA9IHNlbGYuSFByZWQ6R2V0UHJlZGljdChzZWxmLkhQcmVkLlByZXNldHNbJ1Zpa3RvciddWyJXIl0sIHVuaXQsIG15SGVybykKICAKICBpZiBtb2RlID09ICJDb21ibyIgYW5kIHNlbGYuV0hpdENoYW5jZSA+PSBzZWxmLk1lbnUuSGl0Q2hhbmNlLkNvbWJvLldXIG9yIG1vZGUgPT0gbmlsIGFuZCBzZWxmLldIaXRDaGFuY2UgPiAwIHRoZW4KICAgIENhc3RTcGVsbChfVywgc2VsZi5XUG9zLngsIHNlbGYuV1Bvcy56KQogIGVuZAogIAplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gSFRURl9WaWt0b3I6Q2FzdEUodW5pdCwgbW9kZSkKCiAgaWYgdW5pdC5kZWFkIG9yIHVuaXQuaGVhbHRoID09IDAgdGhlbgogICAgcmV0dXJuCiAgZW5kCiAgCiAgaWYgR2V0RGlzdGFuY2UodW5pdCwgbXlIZXJvKSA+IHNlbGYuRS5yYW5nZTEtNSB0aGVuCiAgICBzZWxmLkVTdGFydFBvcyA9IHNlbGY6Q2lyY2xlSW50ZXJzZWN0aW9uKG15SGVybywgdW5pdCwgbXlIZXJvLCBzZWxmLkUucmFuZ2UxLTUpCiAgZWxzZQogICAgc2VsZi5FU3RhcnRQb3MgPSBWZWN0b3IodW5pdC54LCB1bml0LnksIHVuaXQueikKICBlbmQKICAKICBzZWxmLkVQb3MsIHNlbGYuRUhpdENoYW5jZSA9IHNlbGYuSFByZWQ6R2V0UHJlZGljdChzZWxmLkhQcmVkLlByZXNldHNbJ1Zpa3RvciddWyJFIl0sIHVuaXQsIHNlbGYuRVN0YXJ0UG9zKQogIAogIGlmIG1vZGUgPT0gIkNvbWJvIiBhbmQgc2VsZi5FSGl0Q2hhbmNlID49IHNlbGYuTWVudS5IaXRDaGFuY2UuQ29tYm8uRSBvciBtb2RlID09ICJIYXJhc3MiIGFuZCBzZWxmLkVIaXRDaGFuY2UgPj0gc2VsZi5NZW51LkhpdENoYW5jZS5IYXJhc3MuRSBvciBtb2RlID09ICJKRmFybSIgYW5kIHNlbGYuRUhpdENoYW5jZSA+IDAgb3IgbW9kZSA9PSBuaWwgYW5kIHNlbGYuRUhpdENoYW5jZSA+IDEgdGhlbgogICAgQ2FzdFNwZWxsMyhfRSwgRDNEWFZFQ1RPUjMoc2VsZi5FU3RhcnRQb3MueCwgMCwgc2VsZi5FU3RhcnRQb3MueiksIEQzRFhWRUNUT1IzKHNlbGYuRVBvcy54LCAwLCBzZWxmLkVQb3MueikpCiAgZW5kCiAgCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBIVFRGX1Zpa3RvcjpDYXN0Uih1bml0LCBtb2RlKQoKICBpZiB1bml0LmRlYWQgb3IgdW5pdC5oZWFsdGggPT0gMCB0aGVuCiAgICByZXR1cm4KICBlbmQKICAKICBzZWxmLlJQb3MsIHNlbGYuUkhpdENoYW5jZSA9IHNlbGYuSFByZWQ6R2V0UHJlZGljdChzZWxmLkhQcmVkX1IsIHVuaXQsIG15SGVybykKICAKICBpZiBtb2RlID09ICJDb21ibyIgYW5kIHNlbGYuUkhpdENoYW5jZSA+PSBzZWxmLk1lbnUuSGl0Q2hhbmNlLkNvbWJvLlIgb3IgbW9kZSA9PSBuaWwgYW5kIHNlbGYuUkhpdENoYW5jZSA+IDIgdGhlbgogICAgQ2FzdFNwZWxsKF9SLCBzZWxmLlJQb3MueCwgc2VsZi5SUG9zLnopCiAgICBzZWxmLkxhc3RSVGFyZ2V0ID0gdW5pdAogIGVuZAogIAplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gSFRURl9WaWt0b3I6Rm9sbG93Uih1bml0KQoKICBpZiB1bml0LmRlYWQgb3IgdW5pdC5oZWFsdGggPT0gMCB0aGVuCiAgICByZXR1cm4KICBlbmQKICAKICBsb2NhbCBQb3MgPSB1bml0CiAgCiAgaWYgdW5pdC5oYXNNb3ZlUGF0aCBhbmQgdW5pdC5wYXRoQ291bnQgPj0gMiB0aGVuCiAgCiAgICBsb2NhbCBJbmRleFBhdGggPSB1bml0OkdldFBhdGgodW5pdC5wYXRoSW5kZXgpCiAgICAKICAgIGlmIEluZGV4UGF0aCB0aGVuCiAgICAgIFBvcyA9IFBvcysoVmVjdG9yKEluZGV4UGF0aCktUG9zKTpub3JtYWxpemVkKCkqdW5pdC5tcyowLjI1CiAgICBlbmQKICAgIAogIGVuZAogIAogIENhc3RTcGVsbChfUiwgUG9zLngsIFBvcy56KQogIHNlbGYuTGFzdEZvbGxvdyA9IG9zLmNsb2NrKCktR2V0TGF0ZW5jeSgpLzIwMDAKZW5kCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIEhUVEZfVmlrdG9yOkNpcmNsZUludGVyc2VjdGlvbih2MSwgdjIsIGMsIHJhZGl1cykKCiAgYXNzZXJ0KFZlY3RvclR5cGUodjEpIGFuZCBWZWN0b3JUeXBlKHYyKSBhbmQgVmVjdG9yVHlwZShjKSBhbmQgdHlwZShyYWRpdXMpID09ICJudW1iZXIiLCAiS2VuIFZpa3RvcjogQ2lyY2xlSW50ZXJzZWN0aW9uOiB3cm9uZyBhcmd1bWVudCB0eXBlcyAoPFZlY3Rvcj4sIDxWZWN0b3I+LCA8VmVjdG9yPiwgaW50ZWdlciBleHBlY3RlZCkiKQogIAogIGxvY2FsIHgxLCB5MSwgeDIsIHkyLCB4MywgeTMgPSB2MS54LCB2MS56IG9yIHYxLnksIHYyLngsIHYyLnogb3IgdjIueSwgYy54LCBjLnogb3IgYy55CiAgbG9jYWwgciA9IHJhZGl1cwogIGxvY2FsIHhwLCB5cCwgeG0sIHltID0gbmlsLCBuaWwsIG5pbCwgbmlsCiAgbG9jYWwgSXNPblNlZ21lbnQgPSBuaWwKICAKICBpZiB4MSA9PSB4MiB0aGVuCiAgCiAgICBsb2NhbCBCID0gbWF0aC5zcXJ0KHJeMi0oeDEteDMpXjIpCiAgICAKICAgIHhwLCB5cCwgeG0sIHltID0geDEsIHkzK0IsIHgxLCB5My1CCiAgZWxzZQogIAogICAgbG9jYWwgbSA9ICh5Mi15MSkvKHgyLXgxKQogICAgbG9jYWwgbiA9IHkxLW0qeDEKICAgIGxvY2FsIEEgPSB4My1tKihuLXkzKQogICAgbG9jYWwgQiA9IG1hdGguc3FydChBXjItKDErbV4yKSooeDNeMi1yXjIrKG4teTMpXjIpKQogICAgCiAgICB4cCwgeG0gPSAoQStCKS8oMSttXjIpLCAoQS1CKS8oMSttXjIpCiAgICB5cCwgeW0gPSBtKnhwK24sIG0qeG0rbgogIGVuZAogIAogIGlmIHgxIDw9IHgyIHRoZW4KICAgIElzT25TZWdtZW50ID0geDEgPD0geHAgYW5kIHhwIDw9IHgyCiAgZWxzZQogICAgSXNPblNlZ21lbnQgPSB4MiA8PSB4cCBhbmQgeHAgPD0geDEgICAgICAgIAogIGVuZAogIAogIGlmIElzT25TZWdtZW50IHRoZW4KICAgIHJldHVybiBWZWN0b3IoeHAsIDAsIHlwKQogIGVsc2UKICAgIHJldHVybiBWZWN0b3IoeG0sIDAsIHltKQogIGVuZAogIAplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gSFRURl9WaWt0b3I6Q2FzdEkoZW5lbXkpCiAgQ2FzdFNwZWxsKHNlbGYuSWduaXRlLCBlbmVteSkKZW5kCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmZ1bmN0aW9uIEhUVEZfVmlrdG9yOkNhc3RTKGVuZW15KQogIENhc3RTcGVsbChzZWxmLlNtaXRlLCBlbmVteSkKZW5kCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBIVFRGX1Zpa3RvcjpNb3ZlVG9Nb3VzZSgpCgogIGlmIG1vdXNlUG9zIGFuZCBHZXREaXN0YW5jZShtb3VzZVBvcykgPD0gMTAwIHRoZW4KICAgIHNlbGYuTW91c2VQb3MgPSBteUhlcm8rKFZlY3Rvcihtb3VzZVBvcyktbXlIZXJvKTpub3JtYWxpemVkKCkqMzAwCiAgZWxzZQogICAgc2VsZi5Nb3VzZVBvcyA9IG1vdXNlUG9zCiAgZW5kCiAgCiAgbXlIZXJvOk1vdmVUbyhzZWxmLk1vdXNlUG9zLngsIHNlbGYuTW91c2VQb3MueikKZW5kCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBIVFRGX1Zpa3RvcjpEcmF3KCkKCiAgaWYgbm90IHNlbGYuTWVudS5EcmF3Lk9uIG9yIG15SGVyby5kZWFkIHRoZW4KICAgIHJldHVybgogIGVuZAogIAogIGlmIHNlbGYuU3Rvcm0gdGhlbgogICAgc2VsZjpEcmF3Q2lyY2xlcyhzZWxmLlN0b3JtLngsIHNlbGYuU3Rvcm0ueSwgc2VsZi5TdG9ybS56LCBzZWxmLlIucmFkaXVzLCBBUkdCKDB4RkYsIDB4RkYsIDB4RkYsIDB4RkYpKQogIGVuZAogIAogIGlmIHNlbGYuTWVudS5IYXJhc3MuT24gb3Igc2VsZi5NZW51LkhhcmFzcy5PbjIgdGhlbgogICAgRHJhd1RleHQoIkhhcmFzczogT24iLCAyMCwgMTYwMCwgMTUwLCBBUkdCKDB4RkYsIDB4RkYsIDB4ODAsIDB4ODApKQogIGVsc2UKICAgIERyYXdUZXh0KCJIYXJhc3M6IE9mZiIsIDIwLCAxNjAwLCAxNTAsIEFSR0IoMHhGRiwgMHhGRiwgMHhGRiwgMHhGRikpCiAgZW5kCiAgCiAgaWYgc2VsZi5TbWl0ZSB+PSBuaWwgdGhlbgogIAogICAgaWYgc2VsZi5NZW51LkpTdGVhbC5PbiBvciBzZWxmLk1lbnUuSlN0ZWFsLk9uMiB0aGVuCiAgICAgIERyYXdUZXh0KCJKdW5nbGUgU3RlYWw6IE9uIiwgMjAsIDE2MDAsIDIwMCwgQVJHQigweEZGLCAweDgwLCAweDgwLCAweEZGKSkKICAgIGVsc2UKICAgICAgRHJhd1RleHQoIkp1bmdsZSBTdGVhbDogT2ZmIiwgMjAsIDE2MDAsIDIwMCwgQVJHQigweEZGLCAweEZGLCAweEZGLCAweEZGKSkKICAgIGVuZAogICAgCiAgZW5kCiAgCiAgaWYgc2VsZi5NZW51LkRyYXcuVGFyZ2V0LlcgYW5kIHNlbGYuV1RhcmdldCB+PSBuaWwgdGhlbgogICAgc2VsZjpEcmF3Q2lyY2xlcyhzZWxmLldUYXJnZXQueCwgc2VsZi5XVGFyZ2V0LnksIHNlbGYuV1RhcmdldC56LCBzZWxmLlcucmFkaXVzLCBBUkdCKDB4RkYsIDB4RkYsIDB4RkYsIDB4RkYpKQogIGVuZAogIAogIGlmIHNlbGYuTWVudS5EcmF3LlRhcmdldC5FIGFuZCBzZWxmLkVUYXJnZXQgfj0gbmlsIHRoZW4KICAgIHNlbGY6RHJhd0NpcmNsZXMoc2VsZi5FVGFyZ2V0LngsIHNlbGYuRVRhcmdldC55LCBzZWxmLkVUYXJnZXQueiwgc2VsZi5FLndpZHRoLzIsIEFSR0IoMHhGRiwgMHhGRiwgMHhGRiwgMHhGRikpCiAgZW5kCiAgCiAgaWYgc2VsZi5XSGl0Q2hhbmNlIH49IG5pbCB0aGVuCiAgCiAgICBpZiBzZWxmLldIaXRDaGFuY2UgPCAxIHRoZW4KICAgICAgc2VsZi5XY29sb3IgPSBBUkdCKDB4RkYsIDB4RkYsIDB4MDAsIDB4MDApCiAgICBlbHNlaWYgc2VsZi5XSGl0Q2hhbmNlID09IDMgdGhlbgogICAgICBzZWxmLldjb2xvciA9IEFSR0IoMHhGRiwgMHgwMCwgMHg1NCwgMHhGRikKICAgIGVsc2VpZiBzZWxmLldIaXRDaGFuY2UgPj0gMiB0aGVuCiAgICAgIHNlbGYuV2NvbG9yID0gQVJHQigweEZGLCAweDFELCAweERCLCAweDE2KQogICAgZWxzZWlmIHNlbGYuV0hpdENoYW5jZSA+PSAxIHRoZW4KICAgICAgc2VsZi5XY29sb3IgPSBBUkdCKDB4RkYsIDB4RkYsIDB4RTQsIDB4MDApCiAgICBlbmQKICAKICBlbmQKICAKICBpZiBzZWxmLkVIaXRDaGFuY2Ugfj0gbmlsIHRoZW4KICAKICAgIGlmIHNlbGYuRUhpdENoYW5jZSA8IDEgdGhlbgogICAgICBzZWxmLkVjb2xvciA9IEFSR0IoMHhGRiwgMHhGRiwgMHgwMCwgMHgwMCkKICAgIGVsc2VpZiBzZWxmLkVIaXRDaGFuY2UgPT0gMyB0aGVuCiAgICAgIHNlbGYuRWNvbG9yID0gQVJHQigweEZGLCAweDAwLCAweDU0LCAweEZGKQogICAgZWxzZWlmIHNlbGYuRUhpdENoYW5jZSA+PSAyIHRoZW4KICAgICAgc2VsZi5FY29sb3IgPSBBUkdCKDB4RkYsIDB4MUQsIDB4REIsIDB4MTYpCiAgICBlbHNlaWYgc2VsZi5FSGl0Q2hhbmNlID49IDEgdGhlbgogICAgICBzZWxmLkVjb2xvciA9IEFSR0IoMHhGRiwgMHhGRiwgMHhFNCwgMHgwMCkKICAgIGVuZAogIAogIGVuZAogIAogIGlmIHNlbGYuUkhpdENoYW5jZSB+PSBuaWwgdGhlbgogIAogICAgaWYgc2VsZi5SSGl0Q2hhbmNlIDwgMSB0aGVuCiAgICAgIHNlbGYuUmNvbG9yID0gQVJHQigweEZGLCAweEZGLCAweDAwLCAweDAwKQogICAgZWxzZWlmIHNlbGYuUkhpdENoYW5jZSA9PSAzIHRoZW4KICAgICAgc2VsZi5SY29sb3IgPSBBUkdCKDB4RkYsIDB4MDAsIDB4NTQsIDB4RkYpCiAgICBlbHNlaWYgc2VsZi5SSGl0Q2hhbmNlID49IDIgdGhlbgogICAgICBzZWxmLlJjb2xvciA9IEFSR0IoMHhGRiwgMHgxRCwgMHhEQiwgMHgxNikKICAgIGVsc2VpZiBzZWxmLlJIaXRDaGFuY2UgPj0gMSB0aGVuCiAgICAgIHNlbGYuUmNvbG9yID0gQVJHQigweEZGLCAweEZGLCAweEU0LCAweDAwKQogICAgZW5kCiAgCiAgZW5kCiAgCiAgaWYgc2VsZi5NZW51LkRyYXcuUFAuRSBhbmQgc2VsZi5FUG9zIHRoZW4KICAKICAgIHNlbGY6RHJhd0NpcmNsZXMoc2VsZi5FU3RhcnRQb3MueCwgc2VsZi5FU3RhcnRQb3MueSwgc2VsZi5FU3RhcnRQb3Mueiwgc2VsZi5FLndpZHRoLCBBUkdCKDB4RkYsIDB4RkYsIDB4MDAsIDB4MDApKQogICAgc2VsZjpEcmF3Q2lyY2xlcyhzZWxmLkVQb3MueCwgc2VsZi5FUG9zLnksIHNlbGYuRVBvcy56LCBzZWxmLkUud2lkdGgvMiwgc2VsZi5FY29sb3IpCiAgICAKICAgIGlmIHNlbGYuTWVudS5EcmF3LlBQLkxpbmUgdGhlbgogICAgICBEcmF3TGluZTNEKHNlbGYuRVN0YXJ0UG9zLngsIHNlbGYuRVN0YXJ0UG9zLnksIHNlbGYuRVN0YXJ0UG9zLnosIHNlbGYuRVBvcy54LCBzZWxmLkVQb3MueSwgc2VsZi5FUG9zLnosIDIsIHNlbGYuRWNvbG9yKQogICAgZW5kCiAgICAKICAgIHNlbGYuRVBvcyA9IG5pbAogIGVuZAogIAogIGlmIHNlbGYuTWVudS5EcmF3LkhpdGNoYW5jZSB0aGVuCiAgCiAgICBpZiBzZWxmLldIaXRDaGFuY2Ugfj0gbmlsIHRoZW4KICAgICAgRHJhd1RleHQoIlcgSGl0Q2hhbmNlOiAiLi5zZWxmLldIaXRDaGFuY2UsIDIwLCAxMjUwLCA1NTAsIHNlbGYuV2NvbG9yKQogICAgICBzZWxmLldIaXRDaGFuY2UgPSBuaWwKICAgIGVuZAogIAogICAgaWYgc2VsZi5FSGl0Q2hhbmNlIH49IG5pbCB0aGVuCiAgICAgIERyYXdUZXh0KCJFIEhpdENoYW5jZTogIi4uc2VsZi5FSGl0Q2hhbmNlLCAyMCwgMTI1MCwgNjAwLCBzZWxmLkVjb2xvcikKICAgICAgc2VsZi5FSGl0Q2hhbmNlID0gbmlsCiAgICBlbmQKICAKICAgIGlmIHNlbGYuUkhpdENoYW5jZSB+PSBuaWwgdGhlbgogICAgICBEcmF3VGV4dCgiUiBIaXRDaGFuY2U6ICIuLnNlbGYuUkhpdENoYW5jZSwgMjAsIDEyNTAsIDY1MCwgc2VsZi5SY29sb3IpCiAgICAgIHNlbGYuUkhpdENoYW5jZSA9IG5pbAogICAgZW5kCiAgICAKICBlbmQKICAKICBpZiBzZWxmLk1lbnUuRHJhdy5BQSB0aGVuCiAgICBzZWxmOkRyYXdDaXJjbGVzKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIG15SGVyby5yYW5nZStzZWxmOkFkZFJhbmdlKG15SGVybyksIEFSR0IoMHhGRiwgMCwgMHhGRiwgMCkpCiAgZW5kCiAgCiAgaWYgc2VsZi5NZW51LkRyYXcuUSB0aGVuCiAgICBzZWxmOkRyYXdDaXJjbGVzKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIHNlbGYuUS5yYW5nZSwgQVJHQigweEZGLCAweEZGLCAweEZGLCAweEZGKSkKICBlbmQKICAKICBpZiBzZWxmLk1lbnUuRHJhdy5XIGFuZCBzZWxmOlJlYWR5KF9XKSB0aGVuCiAgICBzZWxmOkRyYXdDaXJjbGVzKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIHNlbGYuVy5yYW5nZSwgQVJHQigweEZGLCAweEZGLCAweEZGLCAweEZGKSkKICBlbmQKICAKICBpZiBzZWxmLk1lbnUuRHJhdy5FIHRoZW4KICAgIHNlbGY6RHJhd0NpcmNsZXMobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgc2VsZi5FLnJhbmdlMSwgQVJHQigweEZGLCAweEZGLCAweEZGLCAweEZGKSkKICAgIHNlbGY6RHJhd0NpcmNsZXMobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgc2VsZi5FUmFuZ2UsIEFSR0IoMHhGRiwgMHhGRiwgMHhGRiwgMHhGRikpCiAgZW5kCiAgCiAgaWYgc2VsZi5NZW51LkRyYXcuSSBhbmQgc2VsZjpSZWFkeShzZWxmLklnbml0ZSkgdGhlbgogICAgc2VsZjpEcmF3Q2lyY2xlcyhteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCBzZWxmLkkucmFuZ2UsIEFSR0IoMHhGRiwgMHhGRiwgMHgyNCwgMHgyNCkpCiAgZW5kCiAgCiAgaWYgc2VsZi5NZW51LkRyYXcuUyBhbmQgc2VsZjpSZWFkeShzZWxmLlNtaXRlKSBhbmQgKHNlbGYuTWVudS5KU3RlYWwuT24gb3Igc2VsZi5NZW51LkpTdGVhbC5PbjIpIGFuZCBzZWxmLk1lbnUuSlN0ZWFsLlMgdGhlbgogICAgc2VsZjpEcmF3Q2lyY2xlcyhteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCBzZWxmLlMucmFuZ2UsIEFSR0IoMHhGRiwgMHhGRiwgMHgxNCwgMHg5MykpCiAgZW5kCiAgCiAgaWYgc2VsZi5NZW51LkRyYXcuUGF0aCB0aGVuCiAgCiAgICBpZiBteUhlcm8uaGFzTW92ZVBhdGggYW5kIG15SGVyby5wYXRoQ291bnQgPj0gMiB0aGVuCiAgICAKICAgICAgbG9jYWwgSW5kZXhQYXRoID0gbXlIZXJvOkdldFBhdGgobXlIZXJvLnBhdGhJbmRleCkKICAgICAgCiAgICAgIGlmIEluZGV4UGF0aCB0aGVuCiAgICAgICAgRHJhd0xpbmUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCBJbmRleFBhdGgueCwgSW5kZXhQYXRoLnksIEluZGV4UGF0aC56LCAxLCBBUkdCKDI1NSwgMjU1LCAyNTUsIDI1NSkpCiAgICAgIGVuZAogICAgICAKICAgICAgZm9yIGk9bXlIZXJvLnBhdGhJbmRleCwgbXlIZXJvLnBhdGhDb3VudC0xIGRvCiAgICAgIAogICAgICAgIGxvY2FsIFBhdGggPSBteUhlcm86R2V0UGF0aChpKQogICAgICAgIGxvY2FsIFBhdGgyID0gbXlIZXJvOkdldFBhdGgoaSsxKQogICAgICAgIAogICAgICAgIERyYXdMaW5lM0QoUGF0aC54LCBQYXRoLnksIFBhdGgueiwgUGF0aDIueCwgUGF0aDIueSwgUGF0aDIueiwgMSwgQVJHQigyNTUsIDI1NSwgMjU1LCAyNTUpKQogICAgICBlbmQKICAgICAgCiAgICBlbmQKICAgIAogICAgZm9yIGksIGVuZW15IGluIGlwYWlycyhzZWxmLkVuZW15SGVyb2VzKSBkbwogICAgCiAgICAgIGlmIGVuZW15Lmhhc01vdmVQYXRoIGFuZCBlbmVteS5wYXRoQ291bnQgPj0gMiB0aGVuCiAgICAgIAogICAgICAgIGxvY2FsIEluZGV4UGF0aCA9IGVuZW15OkdldFBhdGgoZW5lbXkucGF0aEluZGV4KQogICAgICAgIAogICAgICAgIGlmIEluZGV4UGF0aCB0aGVuCiAgICAgICAgICBEcmF3TGluZTNEKGVuZW15LngsIGVuZW15LnksIGVuZW15LnosIEluZGV4UGF0aC54LCBJbmRleFBhdGgueSwgSW5kZXhQYXRoLnosIDEsIEFSR0IoMjU1LCAyNTUsIDI1NSwgMjU1KSkKICAgICAgICBlbmQKICAgICAgICAKICAgICAgICBmb3IgaT1lbmVteS5wYXRoSW5kZXgsIGVuZW15LnBhdGhDb3VudC0xIGRvCiAgICAgICAgCiAgICAgICAgICBsb2NhbCBQYXRoID0gZW5lbXk6R2V0UGF0aChpKQogICAgICAgICAgbG9jYWwgUGF0aDIgPSBlbmVteTpHZXRQYXRoKGkrMSkKICAgICAgICAgIAogICAgICAgICAgRHJhd0xpbmUzRChQYXRoLngsIFBhdGgueSwgUGF0aC56LCBQYXRoMi54LCBQYXRoMi55LCBQYXRoMi56LCAxLCBBUkdCKDI1NSwgMjU1LCAyNTUsIDI1NSkpCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgIGVuZAogICAgICAKICAgIGVuZAogICAgCiAgZW5kCiAgCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBIVFRGX1Zpa3RvcjpEcmF3Q2lyY2xlcyh4LCB5LCB6LCByYWRpdXMsIGNvbG9yKQoKICBpZiBzZWxmLk1lbnUuRHJhdy5MZmMgdGhlbgogIAogICAgbG9jYWwgdjEgPSBWZWN0b3IoeCwgeSwgeikKICAgIGxvY2FsIHYyID0gVmVjdG9yKGNhbWVyYVBvcy54LCBjYW1lcmFQb3MueSwgY2FtZXJhUG9zLnopCiAgICBsb2NhbCB0UG9zID0gdjEtKHYxLXYyKTpub3JtYWxpemVkKCkqcmFkaXVzCiAgICBsb2NhbCBzUG9zID0gV29ybGRUb1NjcmVlbihEM0RYVkVDVE9SMyh0UG9zLngsIHRQb3MueSwgdFBvcy56KSkKICAgIAogICAgaWYgT25TY3JlZW4oe3ggPSBzUG9zLngsIHkgPSBzUG9zLnl9LCB7eCA9IHNQb3MueCwgeSA9IHNQb3MueX0pIHRoZW4KICAgICAgc2VsZjpEcmF3Q2lyY2xlczIoeCwgeSwgeiwgcmFkaXVzLCBjb2xvcikgCiAgICBlbmQKICAgIAogIGVsc2UKICAgIERyYXdDaXJjbGUoeCwgeSwgeiwgcmFkaXVzLCBjb2xvcikKICBlbmQKICAKZW5kCgpmdW5jdGlvbiBIVFRGX1Zpa3RvcjpEcmF3Q2lyY2xlczIoeCwgeSwgeiwgcmFkaXVzLCBjb2xvcikKCiAgbG9jYWwgbGVuZ3RoID0gNzUKICBsb2NhbCByYWRpdXMgPSByYWRpdXMqLjkyCiAgbG9jYWwgcXVhbGl0eSA9IG1hdGgubWF4KDgsc2VsZjpyb3VuZCgxODAvbWF0aC5kZWcoKG1hdGguYXNpbigobGVuZ3RoLygyKnJhZGl1cykpKSkpKSkKICBsb2NhbCBxdWFsaXR5ID0gMiptYXRoLnBpL3F1YWxpdHkKICBsb2NhbCBwb2ludHMgPSB7fQogIAogIGZvciB0aGV0YSA9IDAsIDIqbWF0aC5waStxdWFsaXR5LCBxdWFsaXR5IGRvCiAgCiAgICBsb2NhbCBjID0gV29ybGRUb1NjcmVlbihEM0RYVkVDVE9SMyh4K3JhZGl1cyptYXRoLmNvcyh0aGV0YSksIHksIHotcmFkaXVzKm1hdGguc2luKHRoZXRhKSkpCiAgICBwb2ludHNbI3BvaW50cyArIDFdID0gRDNEWFZFQ1RPUjIoYy54LCBjLnkpCiAgZW5kCiAgCiAgRHJhd0xpbmVzMihwb2ludHMsIDEsIGNvbG9yIG9yIDQyOTQ5NjcyOTUpCmVuZAoKZnVuY3Rpb24gSFRURl9WaWt0b3I6cm91bmQobnVtKQoKICBpZiBudW0gPj0gMCB0aGVuCiAgICByZXR1cm4gbWF0aC5mbG9vcihudW0rLjUpCiAgZWxzZQogICAgcmV0dXJuIG1hdGguY2VpbChudW0tLjUpCiAgZW5kCiAgCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gSFRURl9WaWt0b3I6QW5pbWF0aW9uKHVuaXQsIGFuaW1hdGlvbikKCiAgaWYgbm90IHVuaXQuaXNNZSB0aGVuCiAgICByZXR1cm4KICBlbmQKICAKICBpZiBhbmltYXRpb24gPT0gInJlY2FsbCIgdGhlbgogICAgc2VsZi5Jc1JlY2FsbCA9IHRydWUKICBlbHNlaWYgYW5pbWF0aW9uID09ICJyZWNhbGxfd2luZGRvd24iIG9yIGFuaW1hdGlvbiA9PSAiUnVuIiBvciBhbmltYXRpb24gPT0gIlNwZWxsMSIgb3IgYW5pbWF0aW9uID09ICJTcGVsbDIiIG9yIGFuaW1hdGlvbiA9PSAiU3BlbGwzIiBvciBhbmltYXRpb24gPT0gIlNwZWxsNCIgdGhlbgogICAgc2VsZi5Jc1JlY2FsbCA9IGZhbHNlCiAgZW5kCiAgCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBIVFRGX1Zpa3RvcjpDcmVhdGVPYmoob2JqZWN0KQoKICBpZiBvYmplY3QubmFtZSA9PSAiU3Rvcm0iIHRoZW4KICAgIHNlbGYuU3Rvcm0gPSBvYmplY3QKICBlbHNlaWYgb2JqZWN0Lm5hbWUgPT0gIlZpa3Rvcl9DaGFvc1N0b3JtX2dyZWVuLnRyb3kiIHRoZW4KICAgIHNlbGYuU3Rvcm0gPSBvYmplY3QKICBlbHNlCiAgICAtLXByaW50KG9iamVjdC5uYW1lKQogIGVuZAogIAplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gSFRURl9WaWt0b3I6RGVsZXRlT2JqKG9iamVjdCkKCiAgaWYgb2JqZWN0Lm5hbWUgPT0gIlZpa3Rvcl9DaGFvc1N0b3JtX2dyZWVuLnRyb3kiIHRoZW4KICAgIHNlbGYuU3Rvcm0gPSBuaWwKICBlbHNlCiAgICAtLXByaW50KG9iamVjdC5uYW1lKQogIGVuZAogIAplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gSFRURl9WaWt0b3I6UHJvY2Vzc1NwZWxsKHVuaXQsIHNwZWxsKQoKICBpZiBub3QgdW5pdC5pc01lIHRoZW4KICAgIHJldHVybgogIGVuZAogIAogIGlmIHNwZWxsLm5hbWUgPT0gIlZpa3RvclBvd2VyVHJhbnNmZXIiIHRoZW4KICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgc2VsZjpPcmJ3YWxrUmVzZXQoKSBlbmQsIHNwZWxsLndpbmRVcFRpbWUpCiAgZW5kCiAgCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKZnVuY3Rpb24gT25TZW5kUGFja2V0KHApCgogIGlmIEhUVEZfVmlrdG9yLlN0b3JtID09IG5pbCBhbmQgSFRURl9WaWt0b3IuTWVudS5NaXNjLkJsb2NrUiB0aGVuCiAgCiAgICBpZiBHZXRHYW1lVmVyc2lvbigpOmZpbmQoIjUuMjMuMC4yMzkiKSBhbmQgcC5oZWFkZXIgPT0gMHgwQSB0aGVuCiAgICAgIHAucG9zID0gMzEKICAgICAgCiAgICAgIGlmIHA6RGVjb2RlMSgpID09IDB4RUMgYW5kIG5vdCBIVFRGX1Zpa3RvcjpSSGl0KCkgdGhlbgogICAgICAgIEhUVEZfVmlrdG9yOlNjcmlwdE1zZygiU3BlbGwgUiBi4buLIGNo4bq3biIpCiAgICAgICAgcDpCbG9jaygpCiAgICAgIGVuZAogICAgICAKICAgIGVuZAogICAgCiAgZW5kCiAgCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgpmdW5jdGlvbiBIVFRGX1Zpa3RvcjpSSGl0KCkKCiAgZm9yIGksIGVuZW15IGluIGlwYWlycyhzZWxmLkVuZW15SGVyb2VzKSBkbwogIAogICAgaWYgR2V0RGlzdGFuY2UoZW5lbXksIG1vdXNlUG9zKSA8PSBzZWxmLlIucmFkaXVzIHRoZW4KICAgICAgcmV0dXJuIHRydWUKICAgIGVuZAogICAgCiAgZW5kCiAgCiAgcmV0dXJuIGZhbHNlCmVuZAo="), FILE_NAME, "bt", _ENV)()

